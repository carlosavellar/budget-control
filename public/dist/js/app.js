"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var budgetController=function(){var o=function e(t,n,i){_classCallCheck(this,e),this.id=t,this.description=n,this.value=i,this.percentages=-1};o.prototype.calcPercentages=function(e){0<e?(console.log(void 0===e?"undefined":_typeof(e)),console.log((void 0).value),(void 0).percentages=Math.round((void 0).value/e*100)):(void 0).percentages=-1},o.prototype.getPercentages=function(){return(void 0).percentages};var c=function e(t,n,i){_classCallCheck(this,e),this.id=t,this.description=n,this.value=i},e=function(e){var t=0;a.allItems[e].forEach(function(e){return t+=e.value}),a.totais[e]=t},a={allItems:{inc:[],exp:[]},totais:{exp:0,inc:0},budget:0,percentage:-1};return{addItem:function(e,t,n){var i=void 0,l=void 0;return l=0<a.allItems[e].length?a.allItems[e][a.allItems[e].length-1].id+1:0,"inc"===e?i=new c(l,t,n):"exp"===e&&(i=new o(l,t,n)),a.allItems[e].push(i),i},calculateBudget:function(){e("inc"),e("exp"),a.budget=a.totais.inc-a.totais.exp,0<a.totais.inc?a.percentage=Math.round(a.totais.exp/a.totais.inc*100):a.percentage=-1},getBudget:function(){return{budget:a.budget,labelInc:a.totais.inc,labelExp:a.totais.exp,percentage:a.percentage}},testings:function(){console.log(a)},deleteItem:function(e,t){var n;-1!==(n=a.allItems[t].map(function(e){return e.id}).indexOf(e))&&a.allItems[t].splice(n,1)},calculatePercentages:function(){a.allItems.exp.forEach(function(e){return e.calcPercentages(a.totais.inc)})},getPercentages:function(){return a.allItems.exp.map(function(e){return e.getPercentages()})}}}(),uiController=function(){var s={type:".add__type",desc:".add__description",value:".add__value",btn:".add__btn",incList:".income__list",expList:".expenses__list",container:".container",budget:".budget__value",income_lable:".budget__income--value",expense_lable:".budget__expenses--value",month:".budget__title--month",percentage:".budget__expenses--percentage"};return{inputVals:function(){return{getType:document.querySelector(s.type).value,getDesc:document.querySelector(s.desc).value,getValue:parseInt(document.querySelector(s.value).value)}},globlaStrings:function(){return s},clearFields:function(e,t){document.querySelectorAll(e+","+t).forEach(function(e){e.value=""})},addItem:function(e,t){var n,i,l,o,c=void 0,a=void 0,r=void 0;"inc"===t?(r=s.incList,c='<div class="item clearfix" id="inc-%id%"> <div class="item__description"> %desc%</div> <div class="right clearfix"> <div class="item__value">%val%</div> <div class="item__delete"> <button class="item__delete--btn"><i class="ion-ios-close-outline"></i></button> </div> </div> </div>'):"exp"===t&&(r=s.expList,c='<div class="item clearfix" id="exp-%id%"> <div class="item__description"> %desc%</div> <div class="right clearfix"> <div class="item__value">%val%</div> <div class="item__percentage">21%</div> <div class="item__delete"> <button class="item__delete--btn"><i class="ion-ios-close-outline"></i></button> </div> </div> </div>'),a=(a=(a=c.replace("%id%",e.id)).replace("%desc%",e.description)).replace("%val%",(n=e.value,i=t,o=void 0,3<(o=(l=(n=(n=Math.abs(n)).toFixed(2)).split("."))[0]).length&&(o=o.substr(o,o.length-3)+","+o.substr(o.length-3,3)),("inc"===i?"+":"-")+"  "+o+","+l[1])),document.querySelector(r).insertAdjacentHTML("beforeend",a)},displayBudget:function(e){document.querySelector(s.budget).textContent=e.budget,document.querySelector(s.income_lable).textContent=e.labelInc,document.querySelector(s.expense_lable).textContent=e.labelExp,document.querySelector(s.percentage).textContent=e.percentage},deleteItem:function(e){var t=document.getElementById(e);t.parentNode.removeChild(t)}}}(),controller=function(o,c){var n=c.globlaStrings(),a=function(){o.calculateBudget();var e=o.getBudget();c.displayBudget(e)},e=function(e){var t=void 0,n=void 0,i=void 0,l=void 0;(t=e.target.parentNode.parentNode.parentNode.parentNode.id)&&(l=(n=t.split("-"))[0],i=parseFloat(n[1]),o.deleteItem(i,l),a(),c.deleteItem(t))},t=function(){var e,t=void 0;" "!==(e=c.inputVals()).getDesc&&!isNaN(e.getValue)||0<e.getValue?(t=o.addItem(e.getType,e.getDesc,e.getValue),c.addItem(t,e.getType),c.clearFields(n.desc,n.value),a(),console.log("SIM NESSA PORRA")):console.log("Nada nesse caralho")};return{init:function(){document.querySelector(n.btn).addEventListener("click",t),document.addEventListener("keypress",function(e){13!==e.keyCode&&13!==e.which||t()}),document.querySelector(n.container).addEventListener("click",e),c.displayBudget({budget:0,labelInc:0,labelExp:0,percentage:0})}}}(budgetController,uiController);controller.init();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6WyJidWRnZXRDb250cm9sbGVyIiwiRXhwZW5zZSIsImlkIiwiZGVzY3JpcHRpb24iLCJ2YWx1ZSIsIl9jbGFzc0NhbGxDaGVjayIsInRoaXMiLCJwZXJjZW50YWdlcyIsInByb3RvdHlwZSIsInRvdGFsSW5jb21lIiwiY29uc29sZSIsImxvZyIsIl90eXBlb2YiLCJ1bmRlZmluZWQiLCJjYWxjUGVyY2VudGFnZXMiLCJnZXRQZXJjZW50YWdlcyIsIkluY29tZSIsImNhbGNCdWRnZXQiLCJzdW0iLCJkYXRhIiwiYWxsSXRlbXMiLCJ0eXBlIiwiZm9yRWFjaCIsImVyciIsInRvdGFpcyIsImluYyIsImV4cCIsImJ1ZGdldCIsInBlcmNlbnRhZ2UiLCJuZXdpdGVtIiwiSUQiLCJhZGRJdGVtIiwibGVuZ3RoIiwiY2FsY3VsYXRlQnVkZ2V0IiwiZ2V0QnVkZ2V0IiwibGFiZWxJbmMiLCJsYWJlbEV4cCIsImRlbGV0ZUl0ZW0iLCJ0ZXN0aW5ncyIsIml0ZW0iLCJpbmRleCIsIm1hcCIsImN1cnIiLCJpbmRleE9mIiwiY2FsY3VsYXRlUGVyY2VudGFnZXMiLCJ1aUNvbnRyb2xsZXIiLCJkb21zdHJpbmdzIiwiZGVzYyIsImJ0biIsImluY0xpc3QiLCJleHBMaXN0IiwiY29udGFpbmVyIiwiaW50IiwiaW5wdXRWYWxzIiwic3BsaXRudW0iLCJnZXRUeXBlIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiZ2V0VmFsdWUiLCJwYXJzZUludCIsImdsb2JsYVN0cmluZ3MiLCJxdWVyeVNlbGVjdG9yQWxsIiwibnVtIiwibmV3SHRtbCIsImVsZW1lbnQiLCJodG1sIiwib2JqIiwicmVwbGFjZSIsImZvcm1hdERpZ2l0cyIsIk1hdGgiLCJhYnMiLCJ0b0ZpeGVkIiwic3BsaXQiLCJzdWJzdHIiLCJpbnNlcnRBZGphY2VudEhUTUwiLCJ0ZXh0Q29udGVudCIsImluY29tZV9sYWJsZSIsImRpc3BsYXlCdWRnZXQiLCJnZXRFbGVtZW50QnlJZCIsImNvbnRyb2xsZXIiLCJlbCIsInBhcmVudE5vZGUiLCJ1cGRhdGVCdWRnZXQiLCJidWRnZXRDdHJsIiwiY29udHJvbERlbGV0ZUl0ZW0iLCJlIiwic3BsaXRJdGVtIiwidGFyZ2V0IiwiYWRkRXZlbnRMaXN0ZW5lciIsImNvbnRyb2xBZGRJdGVtcyIsImlucHV0IiwiZXZ0Iiwia2V5Q29kZSIsIm5ld0l0ZW0iLCJnZXREZXNjIiwidWlDdHJsIiwiY2xlYXJGaWVsZHMiLCJEb20iLCJ3aGljaCJdLCJtYXBwaW5ncyI6IitVQUVBLElBQU1BLGlCQUFvQixXQUFLLElBRXJCQyxFQUNGLFNBQUFBLEVBQVlDLEVBQUlDLEVBQWFDLEdBQU1DLGdCQUFBQyxLQUFBTCxHQUhyQ0QsS0FBQUEsR0FBQUEsRUFFSUMsS0FGcUJFLFlBR3ZCQSxFQUFtQ0csS0FBQUYsTUFBQUEsRUFJL0JFLEtBQUtDLGFBQWUsR0FEcEJOLEVBQUFPLFVBQWFKLGdCQUFiLFNBQUFLLEdBQ0EsRUFBQUEsR0FQbUJDLFFBQUFDLFNBQUEsSUFBQUYsRUFBQSxZQUFBRyxRQUFBSCxJQWFuQkMsUUFBUUMsVUFBSUUsR0FBS1QsYUFIakJJLEdBQUFBLFlBQVVNLEtBQUFBLFlBQWtCRCxHQUFBVCxNQUFDSyxFQUFjLFlBRTNDQyxHQUFBQSxhQUFtQkQsR0FHdEJSLEVBSkRPLFVBSUtPLGVBQUEsV0FDRCxZQUFBRixHQUFBTixhQWhCbUIsSUFVM0JTLEVBU0FmLFNBQUFBLEVBQVFPLEVBQVVPLEVBQWxCWCxHQUFtQ0MsZ0JBQUFDLEtBQUFVLEdBQy9CVixLQUFPSixHQUFBQSxFQURYSSxLQUFBSCxZQUFBQSxFQU9RRyxLQUFLRixNQUFRQSxHQUFiYSxFQUFhYixTQUFBQSxHQTFCTSxJQUFBYyxFQUFBLEVBa0N2QkMsRUFBS0MsU0FBU0MsR0FBTUMsUUFBUSxTQUFBQyxHQUYxQk4sT0FBQUEsR0FBYU0sRUFBYk4sUUFFRkUsRUFBS0MsT0FBQUEsR0FBZUUsR0FFbkJILEVBRkQsQ0FHQUEsU0FBS0ssQ0FMVEMsSUFBQSxHQU9JTixJQUFLLElB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SUFBVUEsRUFBQUEsV0FBVnhELEVBQUFULEdBQXFCUyxJQUFJVCxFQUFBQSxXQUF6QmtCLEtBY0FpQixFQUFTQyxXQUNURCxJQUFBQSxFQUFTZ0MsT0FBQUEsRUFFREMsT0FESkMsRUFBR0MsRUFBSUMsYUFDSEgsVUFBQUEsTUFBQUEsRUFBQUEsV0FBQUEsRUFBQUEsRUFBQUEsVUFDSEksRUFBQVYsRUFBQXBELFFBQUEyRCxFQUFBbkMsUUFBQW1DLEVBQUFJLFFBQUFKLEVBQUFoQyxVQUhMcUMsRUFBQWhFLFFBQUE4RCxFQUFBSCxFQUFBbkMsU0FGSndDLEVBQUFDLFlBQUFDLEVBQUFsRCxLQUFBa0QsRUFBQTdGLE9BU01xRixJQUNFQyxRQUFBQSxJQUFBQSxvQkFFREEsUUFBTUksSUFBQUEsdUJBS0xaLE1BQUFBLENBQ0F4RSxLQUFBQSxXQXpCQXlFLFNBQUFBLGNBQVc5QyxFQUFXUCxLQUFJVCxpQkFBMUIsUUFBQW9FLEdBQ0FQLFNBQUFBLGlCQUFBQSxXQUFBQSxTQUFBQSxHQUNrQjNDLEtBQWxCd0QsRUFBTzFELFNBQVAsS0FBQXNELEVBQUFPLE9BQ0FULE1BV0pqQyxTQUFTQyxjQUFjd0MsRUFBSTlDLFdBQVdxQyxpQkFBaUIsUUFBU0osR0FLaEVXLEVBUUtsQixjQUFBLENBQ0RuRSxPQUFRQyxFQUNYd0IsU0FBQSxFQWJMQyxTQUFBLEVBaUJNUixXQUFBLE1BL0RVb0QsQ0FvRU43QyxpQkFBQUEsY0FDQUMsV0FBQUEiLCJmaWxlIjoiYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsiXG5cbmNvbnN0IGJ1ZGdldENvbnRyb2xsZXIgPSAoKCkgPT57XG5cbiAgICBjbGFzcyBFeHBlbnNle1xuICAgICAgICBjb25zdHJ1Y3RvcihpZCwgZGVzY3JpcHRpb24sIHZhbHVlKXtcbiAgICAgICAgICAgIHRoaXMuaWQgPSBpZDtcbiAgICAgICAgICAgIHRoaXMuZGVzY3JpcHRpb24gPSBkZXNjcmlwdGlvbjtcbiAgICAgICAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgICAgIHRoaXMucGVyY2VudGFnZXMgPSAtMTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBFeHBlbnNlLnByb3RvdHlwZS5jYWxjUGVyY2VudGFnZXMgPSAodG90YWxJbmNvbWUpPT57XG4gICAgICAgIGlmICh0b3RhbEluY29tZSA+IDApe1xuICAgICAgICAgICAgY29uc29sZS5sb2codHlwZW9mIHRvdGFsSW5jb21lKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHRoaXMudmFsdWUpO1xuICAgICAgICAgICAgdGhpcy5wZXJjZW50YWdlcyA9IE1hdGgucm91bmQoKHRoaXMudmFsdWUgLyB0b3RhbEluY29tZSkgKiAxMDApO1xuICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgIHRoaXMucGVyY2VudGFnZXMgPSAtMTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgRXhwZW5zZS5wcm90b3R5cGUuZ2V0UGVyY2VudGFnZXMgPSAoKT0+e1xuICAgICAgICByZXR1cm4gdGhpcy5wZXJjZW50YWdlcztcbiAgICB9O1xuICAgIGNsYXNzIEluY29tZXtcbiAgICAgICAgY29uc3RydWN0b3IoaWQsIGRlc2NyaXB0aW9uLCB2YWx1ZSl7XG4gICAgICAgICAgICB0aGlzLmlkID0gaWQ7XG4gICAgICAgICAgICB0aGlzLmRlc2NyaXB0aW9uID0gZGVzY3JpcHRpb247XG4gICAgICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBcblxuICAgIGNvbnN0IGNhbGNCdWRnZXQgPSAodHlwZSk9PntcbiAgICAgICAgbGV0IHN1bSA9IDA7XG4gICAgICAgIGRhdGEuYWxsSXRlbXNbdHlwZV0uZm9yRWFjaChlcnI9PntcbiAgICAgICAgICAgIHJldHVybiBzdW0gKz0gZXJyLnZhbHVlO1xuICAgICAgICB9KTtcbiAgICAgICAgZGF0YS50b3RhaXNbdHlwZV0gPSBzdW07XG4gICAgfTtcbiAgICBsZXQgZGF0YT17XG4gICAgICAgIGFsbEl0ZW1zOntcbiAgICAgICAgICAgIGluYzogW10sXG4gICAgICAgICAgICBleHA6IFtdXG4gICAgICAgIH0sXG4gICAgICAgIHRvdGFpczp7XG4gICAgICAgICAgICBleHA6IDAsXG4gICAgICAgICAgICBpbmM6IDBcbiAgICAgICAgfSxcbiAgICAgICAgYnVkZ2V0OiAwLFxuICAgICAgICBwZXJjZW50YWdlOiAtMVxuICAgIH07XG4gICAgcmV0dXJue1xuICAgICAgICBhZGRJdGVtOiAodHlwZSwgZGVzY3JpcHRpb24sIHZhbHVlKT0+e1xuICAgICAgICAgICAgbGV0IG5ld2l0ZW0sIElEO1xuICAgICAgICAgICAgaWYoZGF0YS5hbGxJdGVtc1t0eXBlXS5sZW5ndGggPiAwKXtcbiAgICAgICAgICAgICAgICBJRCA9IGRhdGEuYWxsSXRlbXNbdHlwZV1bZGF0YS5hbGxJdGVtc1t0eXBlXS5sZW5ndGggLSAxXS5pZCArIDE7XG4gICAgICAgICAgICB9ZWxzZSB7XG4gICAgICAgICAgICAgICAgSUQgPSAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYodHlwZSA9PT0gJ2luYycpe1xuICAgICAgICAgICAgICAgIG5ld2l0ZW0gPSBuZXcgSW5jb21lKElELCBkZXNjcmlwdGlvbiwgdmFsdWUpO1xuICAgICAgICAgICAgfWVsc2UgaWYodHlwZSA9PT0gJ2V4cCcpe1xuICAgICAgICAgICAgICAgIG5ld2l0ZW0gPSBuZXcgRXhwZW5zZShJRCwgZGVzY3JpcHRpb24sIHZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGRhdGEuYWxsSXRlbXNbdHlwZV0ucHVzaChuZXdpdGVtKTtcbiAgICAgICAgICAgIHJldHVybiBuZXdpdGVtO1xuICAgICAgICB9LFxuICAgICAgICBjYWxjdWxhdGVCdWRnZXQ6ICgpPT57XG4gICAgICAgICAgICAvLyBjYWxjYXRvdGFsc1xuICAgICAgICAgICAgY2FsY0J1ZGdldCgnaW5jJyk7XG4gICAgICAgICAgICBjYWxjQnVkZ2V0KCdleHAnKTtcblxuICAgICAgICAgICAgLy8gY2FsYyBidWRnZXRcbiAgICAgICAgICAgIGRhdGEuYnVkZ2V0ID0gZGF0YS50b3RhaXMuaW5jIC0gZGF0YS50b3RhaXMuZXhwO1xuXG4gICAgICAgICAgICAvLyBjYWxjIHBlcmNlbnRhZ2VcbiAgICAgICAgICAgIGlmKGRhdGEudG90YWlzLmluYyA+IDApe1xuICAgICAgICAgICAgICAgIGRhdGEucGVyY2VudGFnZSA9IE1hdGgucm91bmQoKGRhdGEudG90YWlzLmV4cCAvIGRhdGEudG90YWlzLmluYykgKiAxMDApO1xuICAgICAgICAgICAgfWVsc2Uge1xuICAgICAgICAgICAgICAgIGRhdGEucGVyY2VudGFnZSA9IC0xO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBnZXRCdWRnZXQ6ICgpPT57XG4gICAgICAgICAgICByZXR1cm57XG4gICAgICAgICAgICAgICAgYnVkZ2V0OiBkYXRhLmJ1ZGdldCxcbiAgICAgICAgICAgICAgICBsYWJlbEluYzogZGF0YS50b3RhaXMuaW5jLFxuICAgICAgICAgICAgICAgIGxhYmVsRXhwOiBkYXRhLnRvdGFpcy5leHAsXG4gICAgICAgICAgICAgICAgcGVyY2VudGFnZTogZGF0YS5wZXJjZW50YWdlXG4gICAgICAgICAgICB9O1xuICAgICAgICB9LFxuICAgICAgICB0ZXN0aW5nczooKT0+e1xuICAgICAgICAgICAgY29uc29sZS5sb2coZGF0YSk7XG4gICAgICAgIH0sXG4gICAgICAgIGRlbGV0ZUl0ZW06IChJRCwgdHlwZSk9PntcbiAgICAgICAgICAgIGxldCBpbmRleCwgaXRlbTtcbiAgICAgICAgICAgIGl0ZW0gPSBkYXRhLmFsbEl0ZW1zW3R5cGVdLm1hcChjdXJyPT57XG4gICAgICAgICAgICAgICAgcmV0dXJuIGN1cnIuaWQ7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGluZGV4ID0gaXRlbS5pbmRleE9mKElEKTtcbiAgICAgICAgICAgIGlmIChpbmRleCAhPT0gLTEpe1xuICAgICAgICAgICAgICAgIGRhdGEuYWxsSXRlbXNbdHlwZV0uc3BsaWNlKGluZGV4LCAxKTsgXG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGNhbGN1bGF0ZVBlcmNlbnRhZ2VzOiAoKT0+e1xuICAgICAgICAgICAgZGF0YS5hbGxJdGVtcy5leHAuZm9yRWFjaChjdXJyPT57XG4gICAgICAgICAgICAgICAgcmV0dXJuIGN1cnIuY2FsY1BlcmNlbnRhZ2VzKGRhdGEudG90YWlzLmluYyk7XG4gICAgICAgICAgICB9KTsgXG4gICAgICAgIH0sXG4gICAgICAgIGdldFBlcmNlbnRhZ2VzOiAoKT0+e1xuICAgICAgICAgICAgbGV0IHBlcmNlID0gZGF0YS5hbGxJdGVtcy5leHAubWFwKGN1cnI9PntcbiAgICAgICAgICAgICAgICByZXR1cm4gY3Vyci5nZXRQZXJjZW50YWdlcygpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gcGVyY2U7XG4gICAgICAgIH1cbiAgICB9O1xufSkoKTtcblxuXG5jb25zdCB1aUNvbnRyb2xsZXIgPSAoKCk9PntcbiAgICAgICAgbGV0IGRvbXN0cmluZ3MgPSB7XG4gICAgICAgICAgICB0eXBlOiBcIi5hZGRfX3R5cGVcIixcbiAgICAgICAgICAgIGRlc2M6IFwiLmFkZF9fZGVzY3JpcHRpb25cIixcbiAgICAgICAgICAgIHZhbHVlOiBcIi5hZGRfX3ZhbHVlXCIsXG4gICAgICAgICAgICBidG46IFwiLmFkZF9fYnRuXCIsXG4gICAgICAgICAgICBpbmNMaXN0OiBcIi5pbmNvbWVfX2xpc3RcIixcbiAgICAgICAgICAgIGV4cExpc3Q6IFwiLmV4cGVuc2VzX19saXN0XCIsXG4gICAgICAgICAgICBjb250YWluZXI6IFwiLmNvbnRhaW5lclwiLFxuICAgICAgICAgICAgYnVkZ2V0OiBcIi5idWRnZXRfX3ZhbHVlXCIsXG4gICAgICAgICAgICBpbmNvbWVfbGFibGU6IFwiLmJ1ZGdldF9faW5jb21lLS12YWx1ZVwiLFxuICAgICAgICAgICAgZXhwZW5zZV9sYWJsZTogXCIuYnVkZ2V0X19leHBlbnNlcy0tdmFsdWVcIixcbiAgICAgICAgICAgIG1vbnRoOiBcIi5idWRnZXRfX3RpdGxlLS1tb250aFwiLFxuICAgICAgICAgICAgcGVyY2VudGFnZTogXCIuYnVkZ2V0X19leHBlbnNlcy0tcGVyY2VudGFnZVwiXG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0ICBmb3JtYXREaWdpdHMgPSAobnVtLCB0eXBlKSA9PiB7XG4gICAgICAgICAgICAgICAgbGV0IGludCwgZGVjLCBzcGxpdG51bTtcbiAgICAgICAgICAgICAgICBudW0gPSBNYXRoLmFicyhudW0pO1xuICAgICAgICAgICAgICAgIG51bSA9IG51bS50b0ZpeGVkKDIpO1xuICAgICAgICAgICAgICAgIHNwbGl0bnVtID0gbnVtLnNwbGl0KCcuJyk7XG4gICAgICAgICAgICAgICAgaW50ID0gc3BsaXRudW1bMF07XG4gICAgICAgICAgICAgICAgaWYgKGludC5sZW5ndGggPiAzKSB7XG4gICAgICAgICAgICAgICAgICAgIGludCA9IGludC5zdWJzdHIoaW50LCBpbnQubGVuZ3RoIC0gMykgKyBcIixcIiArIGludC5zdWJzdHIoaW50Lmxlbmd0aCAgLSAzLCAzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZGVjID0gc3BsaXRudW1bMV07XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gKHR5cGUgPT09IFwiaW5jXCIgPyBcIitcIiA6IFwiLVwiKSArICAnICAnICsgaW50ICsgJywnICsgZGVjO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm57XG4gICAgICAgICAgICBpbnB1dFZhbHM6ICgpPT57XG4gICAgICAgICAgICAgICAgcmV0dXJue1xuICAgICAgICAgICAgICAgICAgICBnZXRUeXBlOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGRvbXN0cmluZ3MudHlwZSkudmFsdWUsXG4gICAgICAgICAgICAgICAgICAgIGdldERlc2M6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoZG9tc3RyaW5ncy5kZXNjKS52YWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgZ2V0VmFsdWU6IHBhcnNlSW50KGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoZG9tc3RyaW5ncy52YWx1ZSkudmFsdWUpXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBnbG9ibGFTdHJpbmdzOigpPT57XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRvbXN0cmluZ3M7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgY2xlYXJGaWVsZHM6KGRlc2MsIHZhbHVlKT0+e1xuICAgICAgICAgICAgICAgIGxldCBpdGVtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChkZXNjICsgXCIsXCIgKyB2YWx1ZSk7XG4gICAgICAgICAgICAgICAgaXRlbS5mb3JFYWNoKGN1cnI9PntcbiAgICAgICAgICAgICAgICAgICAgY3Vyci52YWx1ZSA9ICcnO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGFkZEl0ZW06IChvYmosIHR5cGUpPT57XG4gICAgICAgICAgICAgICAgbGV0IGh0bWwsIG5ld0h0bWwsIGVsZW1lbnQ7XG4gICAgICAgICAgICAgICAgaWYodHlwZSA9PT0gJ2luYycpe1xuICAgICAgICAgICAgICAgICAgICBlbGVtZW50ID0gZG9tc3RyaW5ncy5pbmNMaXN0O1xuICAgICAgICAgICAgICAgICAgICBodG1sID0gJzxkaXYgY2xhc3M9XCJpdGVtIGNsZWFyZml4XCIgaWQ9XCJpbmMtJWlkJVwiPiA8ZGl2IGNsYXNzPVwiaXRlbV9fZGVzY3JpcHRpb25cIj4gJWRlc2MlPC9kaXY+IDxkaXYgY2xhc3M9XCJyaWdodCBjbGVhcmZpeFwiPiA8ZGl2IGNsYXNzPVwiaXRlbV9fdmFsdWVcIj4ldmFsJTwvZGl2PiA8ZGl2IGNsYXNzPVwiaXRlbV9fZGVsZXRlXCI+IDxidXR0b24gY2xhc3M9XCJpdGVtX19kZWxldGUtLWJ0blwiPjxpIGNsYXNzPVwiaW9uLWlvcy1jbG9zZS1vdXRsaW5lXCI+PC9pPjwvYnV0dG9uPiA8L2Rpdj4gPC9kaXY+IDwvZGl2Pic7XG4gICAgICAgICAgICAgICAgfWVsc2UgaWYodHlwZSA9PT0gJ2V4cCcpe1xuICAgICAgICAgICAgICAgICAgICBlbGVtZW50ID0gZG9tc3RyaW5ncy5leHBMaXN0O1xuICAgICAgICAgICAgICAgICAgICBodG1sID0gJzxkaXYgY2xhc3M9XCJpdGVtIGNsZWFyZml4XCIgaWQ9XCJleHAtJWlkJVwiPiA8ZGl2IGNsYXNzPVwiaXRlbV9fZGVzY3JpcHRpb25cIj4gJWRlc2MlPC9kaXY+IDxkaXYgY2xhc3M9XCJyaWdodCBjbGVhcmZpeFwiPiA8ZGl2IGNsYXNzPVwiaXRlbV9fdmFsdWVcIj4ldmFsJTwvZGl2PiA8ZGl2IGNsYXNzPVwiaXRlbV9fcGVyY2VudGFnZVwiPjIxJTwvZGl2PiA8ZGl2IGNsYXNzPVwiaXRlbV9fZGVsZXRlXCI+IDxidXR0b24gY2xhc3M9XCJpdGVtX19kZWxldGUtLWJ0blwiPjxpIGNsYXNzPVwiaW9uLWlvcy1jbG9zZS1vdXRsaW5lXCI+PC9pPjwvYnV0dG9uPiA8L2Rpdj4gPC9kaXY+IDwvZGl2Pic7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIG5ld0h0bWwgPSBodG1sLnJlcGxhY2UoXCIlaWQlXCIsIG9iai5pZCk7XG4gICAgICAgICAgICAgICAgbmV3SHRtbCA9IG5ld0h0bWwucmVwbGFjZShcIiVkZXNjJVwiLCBvYmouZGVzY3JpcHRpb24pO1xuICAgICAgICAgICAgICAgIG5ld0h0bWwgPSBuZXdIdG1sLnJlcGxhY2UoXCIldmFsJVwiLCBmb3JtYXREaWdpdHMob2JqLnZhbHVlLCB0eXBlKSk7XG4gICAgICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihlbGVtZW50KS5pbnNlcnRBZGphY2VudEhUTUwoJ2JlZm9yZWVuZCcsIG5ld0h0bWwpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGRpc3BsYXlCdWRnZXQ6IChvYmopPT57XG4gICAgICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihkb21zdHJpbmdzLmJ1ZGdldCkudGV4dENvbnRlbnQgPSBvYmouYnVkZ2V0O1xuICAgICAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoZG9tc3RyaW5ncy5pbmNvbWVfbGFibGUpLnRleHRDb250ZW50ID0gb2JqLmxhYmVsSW5jO1xuICAgICAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoZG9tc3RyaW5ncy5leHBlbnNlX2xhYmxlKS50ZXh0Q29udGVudCA9IG9iai5sYWJlbEV4cDtcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGRvbXN0cmluZ3MucGVyY2VudGFnZSkudGV4dENvbnRlbnQgPSBvYmoucGVyY2VudGFnZTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBkZWxldGVJdGVtOiAoaXRlbSk9PntcbiAgICAgICAgICAgICAgICBsZXQgZWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpdGVtKTtcbiAgICAgICAgICAgICAgICBlbC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGVsKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBcbiAgICAgICAgfTtcbiAgICB9XG4pKCk7XG5jb25zdCBjb250cm9sbGVyID0gKChidWRnZXRDdHJsLCB1aUN0cmwpPT57XG4gICAgbGV0IERvbSA9IHVpQ3RybC5nbG9ibGFTdHJpbmdzKCk7XG4gICAgXG4gICAgY29uc3QgdXBkYXRlQnVkZ2V0ID0gKCk9PntcbiAgICAgICAgYnVkZ2V0Q3RybC5jYWxjdWxhdGVCdWRnZXQoKTtcbiAgICAgICAgbGV0IGJ1ZGdldCA9IGJ1ZGdldEN0cmwuZ2V0QnVkZ2V0KCk7XG4gICAgICAgIHVpQ3RybC5kaXNwbGF5QnVkZ2V0KGJ1ZGdldCk7XG5cbiAgICB9O1xuICAgIC8vIGNvbnN0IHVwZGF0ZVBlcmNlbnRhZ2VzID0gKCkgPT4ge1xuICAgIC8vICAgYnVkZ2V0Q3RybC5jYWxjdWxhdGVQZXJjZW50YWdlcygpO1xuXG4gICAgLy8gICBsZXQgcGVyY2UgPSBidWRnZXRDdHJsLmdldFBlcmNlbnRhZ2VzKCk7XG4gICAgLy8gICBjb25zb2xlLmxvZyhwZXJjZSk7XG4gICAgLy8gfTtcbiAgICBjb25zdCBjb250cm9sRGVsZXRlSXRlbSA9IChlKT0+e1xuXG4gICAgICAgIGxldCBpdGVtLCBzcGxpdEl0ZW0sIElELCB0eXBlO1xuICAgICAgICBpdGVtID0gZS50YXJnZXQucGFyZW50Tm9kZS5wYXJlbnROb2RlLnBhcmVudE5vZGUucGFyZW50Tm9kZS5pZDtcbiAgICAgICAgaWYgKGl0ZW0pe1xuICAgICAgICAgICAgc3BsaXRJdGVtID0gaXRlbS5zcGxpdCgnLScpO1xuICAgICAgICAgICAgdHlwZSA9IHNwbGl0SXRlbVswXTtcbiAgICAgICAgICAgIElEID0gcGFyc2VGbG9hdChzcGxpdEl0ZW1bMV0pO1xuICAgICAgICAgICAgYnVkZ2V0Q3RybC5kZWxldGVJdGVtKElELCB0eXBlKTtcbiAgICAgICAgICAgIHVwZGF0ZUJ1ZGdldCgpO1xuICAgICAgICAgICAgdWlDdHJsLmRlbGV0ZUl0ZW0oaXRlbSk7XG4gICAgICAgICAgICAvLyB1cGRhdGVQZXJjZW50YWdlcygpO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIGNvbnN0IGV2ZW50TGlzdGVubmVycyA9ICgpPT57XG4gICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoRG9tLmJ0bikuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBjb250cm9sQWRkSXRlbXMpO1xuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlwcmVzcycsIGV2dD0+e1xuICAgICAgICAgICAgaWYoZXZ0LmtleUNvZGUgPT09IDEzIHx8IGV2dC53aGljaCA9PT0gMTMpe1xuICAgICAgICAgICAgICAgIGNvbnRyb2xBZGRJdGVtcygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihEb20uY29udGFpbmVyKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGNvbnRyb2xEZWxldGVJdGVtKTtcbiAgICB9O1xuICAgIGNvbnN0IGNvbnRyb2xBZGRJdGVtcyA9ICgpPT57XG4gICAgICAgIGxldCBpbnB1dCwgbmV3SXRlbTtcbiAgICAgICAgaW5wdXQgPSB1aUN0cmwuaW5wdXRWYWxzKCk7XG4gICAgICAgIGlmKGlucHV0LmdldERlc2MgIT09ICcgJyAmJiAhaXNOYU4oaW5wdXQuZ2V0VmFsdWUpIHx8IGlucHV0LmdldFZhbHVlID4gMCl7XG4gICAgICAgICAgICBuZXdJdGVtID0gYnVkZ2V0Q3RybC5hZGRJdGVtKGlucHV0LmdldFR5cGUsIGlucHV0LmdldERlc2MsIGlucHV0LmdldFZhbHVlKTtcbiAgICAgICAgICAgIHVpQ3RybC5hZGRJdGVtKG5ld0l0ZW0sIGlucHV0LmdldFR5cGUpO1xuICAgICAgICAgICAgLy8gQ2xlYXIgRmllbGRzXG4gICAgICAgICAgICB1aUN0cmwuY2xlYXJGaWVsZHMoRG9tLmRlc2MsIERvbS52YWx1ZSk7XG4gICAgICAgICAgICB1cGRhdGVCdWRnZXQoKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiU0lNIE5FU1NBIFBPUlJBXCIpO1xuICAgICAgICAgICAgLy8gdXBkYXRlUGVyY2VudGFnZXMoKTtcbiAgICAgICAgfWVsc2V7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnTmFkYSBuZXNzZSBjYXJhbGhvJyk7XG4gICAgICAgIH1cbiAgICAgICBcblxuICAgIH07XG4gICAgcmV0dXJue1xuICAgICAgICBpbml0OigpPT57XG4gICAgICAgICAgICBldmVudExpc3Rlbm5lcnMoKTtcbiAgICAgICAgICAgIHVpQ3RybC5kaXNwbGF5QnVkZ2V0KHtcbiAgICAgICAgICAgICAgYnVkZ2V0OiAwLFxuICAgICAgICAgICAgICBsYWJlbEluYzogMCxcbiAgICAgICAgICAgICAgbGFiZWxFeHA6IDAsXG4gICAgICAgICAgICAgIHBlcmNlbnRhZ2U6IDBcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxufVxuKShidWRnZXRDb250cm9sbGVyLCB1aUNvbnRyb2xsZXIpO1xuY29udHJvbGxlci5pbml0KCk7XG5cbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==

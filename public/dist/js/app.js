"use strict";var _createClass=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var budgetController=function(){console.log("Budget");var a=function(){function i(e,t,n){_classCallCheck(this,i),this.id=e,this.description=t,this.value=n}return _createClass(i,[{key:"calcPercentages",value:function(e){this.percentages=0<e?Math.round(this.value/e*100):-1}},{key:"getPercentages",value:function(){return this.percentages}}]),i}(),l=function e(t,n,i){_classCallCheck(this,e),this.id=t,this.description=n,this.value=i},r={allItems:{inc:[],exp:[]},totals:{inc:0,exp:0},budget:0,percentage:-1},e=function(e){var t=0;return r.allItems[e].forEach(function(e){return t+=e.value}),r.totals[e]=t};return{addItem:function(e,t,n){var i=void 0,c=void 0;return i=0<r.allItems[e].length?r.allItems[e][r.allItems[e].length-1].id+1:0,"inc"===e?c=new l(i,t,n):"exp"===e&&(c=new a(i,t,n)),r.allItems[e].push(c),c},testings:function(){return r},calculateBudget:function(){e("inc"),e("exp"),r.budget=r.totals.inc-r.totals.exp,console.log(r.totals.inc),0<r.totals.inc?r.percentage=Math.round(r.totals.exp/r.totals.inc*100):r.percentage=-1},getBudget:function(){return{incLable:r.totals.inc,expLable:r.totals.exp,budget:r.budget,percentage:r.percentage}},deleteItem:function(e,t){var n;-1!==(n=r.allItems[e].map(function(e){return e.id}).indexOf(t))&&r.allItems[e].splice(n,1)},calculatePercentages:function(){r.allItems.exp.forEach(function(e){return e.calcPercentages(r.totals.inc)})},getPercentages:function(){return r.allItems.exp.map(function(e){return e.getPercentages()})}}}(),uiController=function(){var a={type:".add__type",desc:".add__description",value:".add__value",btn:".add__btn",incList:".income__list",expList:".expenses__list",container:".container",budget:".budget__value",income_lable:".budget__income--value",expense_lable:".budget__expenses--value",month:".budget__title--month",percentage:".budget__expenses--percentage",item_perce:".item__percentage"},n=function(e,t){var n,i,c=void 0;return c=(i=(e=(e=Math.abs(e)).toFixed(2)).split("."))[0],n=i[1],3<c.length&&(c=c.substr(0,c.length-3)+"."+c.substr(c.length-3,3)),("inc"===t?"+":"-")+" "+c+","+n};return{inputVals:function(){return{getType:document.querySelector(a.type).value,getDesc:document.querySelector(a.desc).value,getValue:parseInt(document.querySelector(a.value).value)}},globalInput:function(){return a},addItem:function(e,t){var n=void 0,i=void 0,c=void 0;"inc"===e?(c=a.incList,n='<div class="item clearfix" id="inc-%id%"> <div class="item__description">%desc%</div> <div class="right clearfix"> <div class="item__value">%val%</div> <div class="item__delete"> <button class="item__delete--btn"><i class="ion-ios-close-outline"></i></button> </div> </div> </div>'):"exp"===e&&(c=a.expList,n='<div class="item clearfix" id="exp-%id%"> <div class="item__description">%desc%</div> <div class="right clearfix"> <div class="item__value">%val%</div> <div class="item__percentage">%iPerce%</div> <div class="item__delete"> <button class="item__delete--btn"><i class="ion-ios-close-outline"></i></button> </div> </div> </div>'),i=(i=(i=(i=n.replace("%id%",t.id)).replace("%desc%",t.description)).replace("%val%",t.value)).replace("%iPerce%",t.percentages),document.querySelector(c).insertAdjacentHTML("beforeend",i)},displayBudget:function(e){var t=void 0;t=0<e.budget?"inc":"exp",document.querySelector(a.budget).textContent=n(e.budget,t),document.querySelector(a.income_lable).textContent=n(e.incLable,"+"),document.querySelector(a.expense_lable).textContent=n(e.expLable,"-"),document.querySelector(a.percentage).textContent=e.percentage},displayPercentages:function(n){!function(e,t){for(var n=0;n<e.length;n++)t(e[n],n)}(document.querySelectorAll(a.item_perce),function(e,t){e.textContent=n[t]+"%"})}}}(),controller=function(a,n){var e=n.globalInput(),l=function(){var e;a.calculateBudget(),e=a.getBudget(),n.displayBudget(e)},t=function(e){var t=void 0,n=void 0,i=void 0,c=void 0;(t=e.target.parentNode.parentNode.parentNode.parentNode.id)&&(i=(n=t.split("-"))[0],c=parseFloat(n[1]),a.deleteItem(i,c),l())},i=function(){var e,t=void 0;""===(e=n.inputVals()).getDesc||isNaN(e.getValue)?alert("Hey, this is not Ok"):(t=a.addItem(e.getType,e.getDesc,e.getValue),n.addItem(e.getType,t),l(),function(){a.calculatePercentages();var e=a.getPercentages();console.log(e+" e"),n.displayPercentages(e)}())};return{init:function(){document.querySelector(e.btn).addEventListener("click",i),document.addEventListener("keypress",function(e){13!==e.keycode&&13!==e.which||i()}),a.testings(),document.querySelector(e.container).addEventListener("click",t),n.displayBudget({incLable:0,expLable:0,budget:0,percentage:0})}}}(budgetController,uiController);controller.init();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6WyJidWRnZXRDb250cm9sbGVyIiwiY29uc29sZSIsImxvZyIsIkV4cGVuc2UiLCJpZCIsImRlc2NyaXB0aW9uIiwidmFsdWUiLCJfY2xhc3NDYWxsQ2hlY2siLCJ0aGlzIiwiX2NyZWF0ZUNsYXNzIiwia2V5IiwidG90YWxJbmNvbWUiLCJwZXJjZW50YWdlcyIsIk1hdGgiLCJyb3VuZCIsIkluY29tZSIsImRhdGEiLCJhbGxJdGVtcyIsImluYyIsImV4cCIsInRvdGFscyIsImJ1ZGdldCIsInBlcmNlbnRhZ2UiLCJjYWxjVG90YWxzIiwic3VtIiwidHlwZSIsImZvckVhY2giLCJjdXJyIiwiSUQiLCJuZXdJdGVtIiwibGVuZ3RoIiwicHVzaCIsInRlc3RpbmdzIiwiYWRkSXRlbSIsImdldEJ1ZGdldCIsImluY0xhYmxlIiwiZXhwTGFibGUiLCJjYWxjdWxhdGVCdWRnZXQiLCJkZWxldGVJdGVtIiwiaW5kZXgiLCJtYXAiLCJpbmRleE9mIiwiY2FsY1BlcmNlbnRhZ2VzIiwidWlDb250cm9sbGVyIiwiaXRlbSIsImRlc2MiLCJidG4iLCJleHBMaXN0IiwiY29udGFpbmVyIiwiY2FsY3VsYXRlUGVyY2VudGFnZXMiLCJpbmNvbWVfbGFibGUiLCJleHBlbnNlX2xhYmxlIiwibW9udGgiLCJpdGVtX3BlcmNlIiwiZm9ybWFyRGlnaXRzIiwibnVtIiwiZ2V0UGVyY2VudGFnZXMiLCJpbnQiLCJzcGxpdE51bSIsImFicyIsInBlcmMiLCJkZWMiLCJzdWJzdHIiLCJpbmNMaXN0IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiZG9tc3RyaW5ncyIsInBhcnNlSW50Iiwib2JqIiwiaHRtbCIsIm5ld0h0bWwiLCJlbGVtZW50IiwidG9GaXhlZCIsInJlcGxhY2UiLCJpbnNlcnRBZGphY2VudEhUTUwiLCJkaXNwbGF5QnVkZ2V0IiwiaW5wdXRWYWxzIiwidGV4dENvbnRlbnQiLCJnZXRUeXBlIiwiZ2V0RGVzYyIsImRpc3BsYXlQZXJjZW50YWdlcyIsImxpc3QiLCJjYWxsYmFjayIsImkiLCJub2RlTGlzdEZvckVhY2giLCJxdWVyeVNlbGVjdG9yQWxsIiwiY3VycmVudCIsInVpQ3RybCIsIkRvbSIsImdsb2JhbElucHV0IiwiY29uc3Ryb2xsRGVsZXRlSXRlbSIsImUiLCJzcGxpdGVkSXRlbSIsInRhcmdldCIsInBhcmVudE5vZGUiLCJ1cGRhdGVCdWRnZXQiLCJidWRnZXRDdHJsIiwiY29udHJvbEFkZEl0ZW0iLCJpbnB1dCIsImlzTmFOIiwiZ2V0VmFsdWUiLCJhbGVydCIsImxpc3RQZXJjIiwiYWRkRXZlbnRMaXN0ZW5lciIsIndoaWNoIiwidXBkYXRlUGVyY2VudGFnZXMiXSwibWFwcGluZ3MiOiI2WEFBQSxJQUFNQSxpQkFBb0IsV0FFdEJDLFFBQVFDLElBQUksVUFGZ0IsSUFJdEJDLEVBSnNCLFdBS3hCLFNBQUFBLEVBQVlDLEVBQUlDLEVBQWFDLEdBQU9DLGdCQUFBQyxLQUFBTCxHQUx0Q0gsS0FBQUEsR0FBQUEsRUFPTVEsS0FBS0gsWUFBY0EsRUFMbkJILEtBQUlJLE1BQVpBLEVBRjRCLE9BQUFHLGFBQUFOLEVBQUEsQ0FBQSxDQUFBTyxJQUFBLGtCQUFBSixNQUFBLFNBQUFLLEdBS1lILEtBQUFJLFlBQXBCUCxFQUFoQk0sRUFBb0NFLEtBQUFDLE1BQUFOLEtBQUFGLE1BQUFLLEVBQUEsTUFDaEMsSUFOb0IsQ0FBQUQsSUFBQSxpQkFBQUosTUFBQSxXQWtCcEIsT0FBT0UsS0FBS0ksZ0JBbEJRVCxFQUFBLEdBWWhCWSxFQUNILFNBQUFBLEVBRkRYLEVBRUtDLEVBQUFDLEdBQUFDLGdCQUFBQyxLQUFBTyxHQUNEUCxLQUFBSixHQUFBQSxFQUNISSxLQUFBSCxZQUFBQSxFQUNKRyxLQUFBRixNQUFBQSxHQWhCdUJVLEVBQUEsQ0FrQnBCQyxTQUFBLENBQ0hDLElBQUEsR0FuQnVCQyxJQUFBLElBQUFDLE9BQUEsQ0FBQUYsSUFBQSxFQXFDcEJDLElBQUssR0FiMkJFLE9BQUEsRUFnQnBDQyxZQUFhLEdBYlRDLEVBQWFqQixT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Q0FVLFdBQUFBIiwiZmlsZSI6ImFwcC5qcyIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IGJ1ZGdldENvbnRyb2xsZXIgPSAoKCkgPT4ge1xuICAgIFxuICAgIGNvbnNvbGUubG9nKFwiQnVkZ2V0XCIpO1xuXG4gICAgY2xhc3MgRXhwZW5zZSB7XG4gICAgICAgIGNvbnN0cnVjdG9yKGlkLCBkZXNjcmlwdGlvbiwgdmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuaWQgPSBpZDtcbiAgICAgICAgICAgIHRoaXMuZGVzY3JpcHRpb24gPSBkZXNjcmlwdGlvbjtcbiAgICAgICAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBjYWxjUGVyY2VudGFnZXMgKHRvdGFsSW5jb21lKXtcbiAgICAgICAgICAgIGlmKHRvdGFsSW5jb21lID4gMCkge1xuICAgICAgICAgICAgICAgIHRoaXMucGVyY2VudGFnZXMgPSBNYXRoLnJvdW5kKCh0aGlzLnZhbHVlIC8gdG90YWxJbmNvbWUpICogMTAwKTtcbiAgICAgICAgICAgIH1lbHNle1xuICAgICAgICAgICAgICAgIHRoaXMucGVyY2VudGFnZXMgPSAtMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBnZXRQZXJjZW50YWdlcygpe1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucGVyY2VudGFnZXM7XG4gICAgICAgIH1cbiAgICAgICBcbiAgICB9XG4gICAgXG4gICAgY2xhc3MgSW5jb21lIHtcbiAgICAgICAgY29uc3RydWN0b3IoaWQsIGRlc2NyaXB0aW9uLCB2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5pZCA9IGlkO1xuICAgICAgICAgICAgdGhpcy5kZXNjcmlwdGlvbiA9IGRlc2NyaXB0aW9uO1xuICAgICAgICAgICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIGxldCBkYXRhID0ge1xuICAgICAgICBhbGxJdGVtczoge1xuICAgICAgICAgICAgaW5jOiBbXSxcbiAgICAgICAgICAgIGV4cDogW11cbiAgICAgICAgfSxcbiAgICAgICAgdG90YWxzOiB7XG4gICAgICAgICAgICBpbmM6IDAsXG4gICAgICAgICAgICBleHA6IDBcbiAgICAgICAgfSxcbiAgICAgICAgYnVkZ2V0OiAwLFxuICAgICAgICBwZXJjZW50YWdlOiAtMVxuICAgIH07XG5cbiAgICBjb25zdCBjYWxjVG90YWxzID0gKHR5cGUpID0+IHtcbiAgICAgICAgbGV0IHN1bSA9IDA7XG4gICAgICAgIGRhdGEuYWxsSXRlbXNbdHlwZV0uZm9yRWFjaChjdXJyID0+IHN1bSArPSBjdXJyLnZhbHVlKTtcblxuICAgICAgICBkYXRhLnRvdGFsc1t0eXBlXSA9IHN1bTtcblxuICAgICAgICByZXR1cm4gc3VtO1xuICAgIH07XG5cbiAgICByZXR1cm4ge1xuICAgICAgICBhZGRJdGVtOiAodHlwZSwgZGVzY3JpcHRpb24sIHZhbHVlKSA9PiB7XG4gICAgICAgICAgICBsZXQgSUQsIG5ld0l0ZW07XG4gICAgICAgICAgICBpZiAoZGF0YS5hbGxJdGVtc1t0eXBlXS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgSUQgPSBkYXRhLmFsbEl0ZW1zW3R5cGVdW2RhdGEuYWxsSXRlbXNbdHlwZV0ubGVuZ3RoIC0gMV0uaWQgKyAxO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBJRCA9IDA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodHlwZSA9PT0gJ2luYycpIHtcbiAgICAgICAgICAgICAgICBuZXdJdGVtID0gbmV3IEluY29tZShJRCwgZGVzY3JpcHRpb24sIHZhbHVlKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gJ2V4cCcpIHtcbiAgICAgICAgICAgICAgICBuZXdJdGVtID0gbmV3IEV4cGVuc2UoSUQsIGRlc2NyaXB0aW9uLCB2YWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBkYXRhLmFsbEl0ZW1zW3R5cGVdLnB1c2gobmV3SXRlbSk7XG4gICAgICAgICAgICByZXR1cm4gbmV3SXRlbTtcbiAgICAgICAgfSxcbiAgICAgICAgdGVzdGluZ3M6ICgpID0+IHtcbiAgICAgICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgICB9LFxuICAgICAgICBjYWxjdWxhdGVCdWRnZXQ6ICgpID0+IHtcbiAgICAgICAgICAgIC8vICBjYWxjIFRvdGxhc1xuICAgICAgICAgICAgY2FsY1RvdGFscygnaW5jJyk7XG4gICAgICAgICAgICBjYWxjVG90YWxzKCdleHAnKTtcbiAgICAgICAgICAgIC8vIGNhbGMgYnVkZ2V0XG4gICAgICAgICAgICBkYXRhLmJ1ZGdldCA9IGRhdGEudG90YWxzLmluYyAtIGRhdGEudG90YWxzLmV4cDtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGEudG90YWxzLmluYyk7XG4gICAgICAgICAgICAvLyBDYWxjIHBlcmNlbnRhZ2UgXG4gICAgICAgICAgICBpZiAoZGF0YS50b3RhbHMuaW5jID4gMCkge1xuICAgICAgICAgICAgICAgIGRhdGEucGVyY2VudGFnZSA9IE1hdGgucm91bmQoKGRhdGEudG90YWxzLmV4cCAvIGRhdGEudG90YWxzLmluYykgKiAxMDApO1xuICAgICAgICAgICAgfWVsc2Uge1xuXG4gICAgICAgICAgICAgICAgZGF0YS5wZXJjZW50YWdlID0gLTE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGdldEJ1ZGdldDogKCk9PntcbiAgICAgICAgICAgIHJldHVybntcbiAgICAgICAgICAgICAgICAgaW5jTGFibGU6IGRhdGEudG90YWxzLmluYyxcbiAgICAgICAgICAgICAgICAgZXhwTGFibGU6IGRhdGEudG90YWxzLmV4cCxcbiAgICAgICAgICAgICAgICAgYnVkZ2V0OiBkYXRhLmJ1ZGdldCxcbiAgICAgICAgICAgICAgICAgcGVyY2VudGFnZTogZGF0YS5wZXJjZW50YWdlXG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGRlbGV0ZUl0ZW06ICh0eXBlLCBJRCk9PntcbiAgICAgICAgICAgIGxldCBpdGVtLCBpbmRleDtcbiAgICAgICAgICAgIGl0ZW0gPSBkYXRhLmFsbEl0ZW1zW3R5cGVdLm1hcChjdXJyID0+IGN1cnIuaWQpO1xuICAgICAgICAgICAgaW5kZXggPSBpdGVtLmluZGV4T2YoSUQpO1xuICAgICAgICAgICAgaWYoaW5kZXggIT09ICAtMSApe1xuICAgICAgICAgICAgICAgIGRhdGEuYWxsSXRlbXNbdHlwZV0uc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgY2FsY3VsYXRlUGVyY2VudGFnZXM6ICgpID0+IHtcbiAgICAgICAgICAvKiBJIHdpbGwgbG9vcCB0aHJvdWdoIHRoZSBhbGwgZXhwZW5zZSB2YWx1ZSBhbmQgdXNlIGEgbWV0aG9kIHRvIGNhbGN1bGF0ZSBlYXRoXG4gICAgICAgICAgICBleHBlbnNlIFxuICAgICAgICAgICAgZXhwZW5zZSAgKi9cbiAgICAgICAgICAgIGRhdGEuYWxsSXRlbXNbJ2V4cCddLmZvckVhY2goY3Vycj0+Y3Vyci5jYWxjUGVyY2VudGFnZXMoZGF0YS50b3RhbHMuaW5jKSk7XG4gICAgICAgIH0sXG4gICAgICAgIGdldFBlcmNlbnRhZ2VzOiAoKSA9PiB7XG4gICAgICAgICAgICAvLyBoZXJlIGkgd2lsbCBjcmVhdGUgYSBuZXdzIGFycmF5IHdpdGggZXhhY2ggbmV3cyBwZXJjZW50YWdlIFxuICAgICAgICAgICAgbGV0IHBlcmMgPSBkYXRhLmFsbEl0ZW1zWydleHAnXS5tYXAoY3Vycj0+Y3Vyci5nZXRQZXJjZW50YWdlcygpKTtcbiAgICAgICAgICAgIHJldHVybiBwZXJjO1xuICAgICAgICB9LFxuICAgIH07XG59KSgpO1xuY29uc3QgdWlDb250cm9sbGVyID0gKCgpID0+IHtcbiAgICBsZXQgZG9tc3RyaW5ncyA9IHtcbiAgICAgICAgdHlwZTogXCIuYWRkX190eXBlXCIsXG4gICAgICAgIGRlc2M6IFwiLmFkZF9fZGVzY3JpcHRpb25cIixcbiAgICAgICAgdmFsdWU6IFwiLmFkZF9fdmFsdWVcIixcbiAgICAgICAgYnRuOiBcIi5hZGRfX2J0blwiLFxuICAgICAgICBpbmNMaXN0OiBcIi5pbmNvbWVfX2xpc3RcIixcbiAgICAgICAgZXhwTGlzdDogXCIuZXhwZW5zZXNfX2xpc3RcIixcbiAgICAgICAgY29udGFpbmVyOiBcIi5jb250YWluZXJcIixcbiAgICAgICAgYnVkZ2V0OiBcIi5idWRnZXRfX3ZhbHVlXCIsXG4gICAgICAgIGluY29tZV9sYWJsZTogXCIuYnVkZ2V0X19pbmNvbWUtLXZhbHVlXCIsXG4gICAgICAgIGV4cGVuc2VfbGFibGU6IFwiLmJ1ZGdldF9fZXhwZW5zZXMtLXZhbHVlXCIsXG4gICAgICAgIG1vbnRoOiBcIi5idWRnZXRfX3RpdGxlLS1tb250aFwiLFxuICAgICAgICBwZXJjZW50YWdlOiBcIi5idWRnZXRfX2V4cGVuc2VzLS1wZXJjZW50YWdlXCIsXG4gICAgICAgIGl0ZW1fcGVyY2U6IFwiLml0ZW1fX3BlcmNlbnRhZ2VcIlxuICAgIH07XG4gICAgY29uc3QgZm9ybWFyRGlnaXRzID0gKG51bSwgdHlwZSk9PntcbiAgICAgICAgbGV0IGludCwgZGVjLCBzcGxpdE51bTtcbiAgICAgICAgbnVtID0gTWF0aC5hYnMobnVtKTtcbiAgICAgICAgbnVtID0gbnVtLnRvRml4ZWQoMik7XG4gICAgICAgIHNwbGl0TnVtID0gbnVtLnNwbGl0KCcuJyk7XG4gICAgICAgIGludCA9IHNwbGl0TnVtWzBdO1xuICAgICAgICBkZWMgPSBzcGxpdE51bVsxXTtcbiAgICAgICAgaWYoaW50Lmxlbmd0aCA+IDMpe1xuICAgICAgICAgICAgaW50ID0gaW50LnN1YnN0cigwLCBpbnQubGVuZ3RoIC0gMykgKyAnLicgKyBpbnQuc3Vic3RyKGludC5sZW5ndGggLSAzLCAzKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gKHR5cGUgPT09ICdpbmMnID8gJysnIDogJy0nKSArICcgJyArIGludCArICcsJyArIGRlYztcbiAgICAgICAgLy8gbnVtID0gbnVtXG4gICAgfTtcbiAgICByZXR1cm4ge1xuICAgICAgICBpbnB1dFZhbHM6ICgpID0+IHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgZ2V0VHlwZTogZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihkb21zdHJpbmdzLnR5cGUpLnZhbHVlLFxuICAgICAgICAgICAgICAgIGdldERlc2M6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoZG9tc3RyaW5ncy5kZXNjKS52YWx1ZSxcbiAgICAgICAgICAgICAgICBnZXRWYWx1ZTogcGFyc2VJbnQoZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihkb21zdHJpbmdzLnZhbHVlKS52YWx1ZSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgZ2xvYmFsSW5wdXQ6ICgpID0+IHtcbiAgICAgICAgICAgIHJldHVybiBkb21zdHJpbmdzO1xuICAgICAgICB9LFxuICAgICAgICBhZGRJdGVtOiAodHlwZSwgb2JqKSA9PiB7XG4gICAgICAgICAgICBsZXQgaHRtbCwgbmV3SHRtbCwgZWxlbWVudDtcbiAgICAgICAgICAgIGlmICh0eXBlID09PSAnaW5jJykge1xuICAgICAgICAgICAgICAgIGVsZW1lbnQgPSBkb21zdHJpbmdzLmluY0xpc3Q7XG4gICAgICAgICAgICAgICAgaHRtbCA9ICc8ZGl2IGNsYXNzPVwiaXRlbSBjbGVhcmZpeFwiIGlkPVwiaW5jLSVpZCVcIj4gPGRpdiBjbGFzcz1cIml0ZW1fX2Rlc2NyaXB0aW9uXCI+JWRlc2MlPC9kaXY+IDxkaXYgY2xhc3M9XCJyaWdodCBjbGVhcmZpeFwiPiA8ZGl2IGNsYXNzPVwiaXRlbV9fdmFsdWVcIj4ldmFsJTwvZGl2PiA8ZGl2IGNsYXNzPVwiaXRlbV9fZGVsZXRlXCI+IDxidXR0b24gY2xhc3M9XCJpdGVtX19kZWxldGUtLWJ0blwiPjxpIGNsYXNzPVwiaW9uLWlvcy1jbG9zZS1vdXRsaW5lXCI+PC9pPjwvYnV0dG9uPiA8L2Rpdj4gPC9kaXY+IDwvZGl2Pic7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICdleHAnKSB7XG4gICAgICAgICAgICAgICAgZWxlbWVudCA9IGRvbXN0cmluZ3MuZXhwTGlzdDtcbiAgICAgICAgICAgICAgICBodG1sID0gJzxkaXYgY2xhc3M9XCJpdGVtIGNsZWFyZml4XCIgaWQ9XCJleHAtJWlkJVwiPiA8ZGl2IGNsYXNzPVwiaXRlbV9fZGVzY3JpcHRpb25cIj4lZGVzYyU8L2Rpdj4gPGRpdiBjbGFzcz1cInJpZ2h0IGNsZWFyZml4XCI+IDxkaXYgY2xhc3M9XCJpdGVtX192YWx1ZVwiPiV2YWwlPC9kaXY+IDxkaXYgY2xhc3M9XCJpdGVtX19wZXJjZW50YWdlXCI+JWlQZXJjZSU8L2Rpdj4gPGRpdiBjbGFzcz1cIml0ZW1fX2RlbGV0ZVwiPiA8YnV0dG9uIGNsYXNzPVwiaXRlbV9fZGVsZXRlLS1idG5cIj48aSBjbGFzcz1cImlvbi1pb3MtY2xvc2Utb3V0bGluZVwiPjwvaT48L2J1dHRvbj4gPC9kaXY+IDwvZGl2PiA8L2Rpdj4nO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbmV3SHRtbCA9IGh0bWwucmVwbGFjZSgnJWlkJScsIG9iai5pZCk7XG4gICAgICAgICAgICBuZXdIdG1sID0gbmV3SHRtbC5yZXBsYWNlKCclZGVzYyUnLCBvYmouZGVzY3JpcHRpb24pO1xuICAgICAgICAgICAgbmV3SHRtbCA9IG5ld0h0bWwucmVwbGFjZSgnJXZhbCUnLCBvYmoudmFsdWUpO1xuICAgICAgICAgICAgbmV3SHRtbCA9IG5ld0h0bWwucmVwbGFjZSgnJWlQZXJjZSUnLCBvYmoucGVyY2VudGFnZXMpO1xuICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihlbGVtZW50KS5pbnNlcnRBZGphY2VudEhUTUwoJ2JlZm9yZWVuZCcsIG5ld0h0bWwpO1xuICAgICAgICB9LFxuICAgICAgICBkaXNwbGF5QnVkZ2V0OiAob2JqKT0+e1xuICAgICAgICAgICAgbGV0IHR5cGU7XG4gICAgICAgICAgICBvYmouYnVkZ2V0ID4gMCA/IHR5cGUgPSAnaW5jJyA6IHR5cGUgPSAnZXhwJzsgXG4gICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGRvbXN0cmluZ3MuYnVkZ2V0KS50ZXh0Q29udGVudCA9IGZvcm1hckRpZ2l0cyhvYmouYnVkZ2V0LCB0eXBlKTtcbiAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoZG9tc3RyaW5ncy5pbmNvbWVfbGFibGUpLnRleHRDb250ZW50ID0gZm9ybWFyRGlnaXRzKG9iai5pbmNMYWJsZSwgJysnICk7XG4gICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGRvbXN0cmluZ3MuZXhwZW5zZV9sYWJsZSkudGV4dENvbnRlbnQgPSBmb3JtYXJEaWdpdHMob2JqLmV4cExhYmxlLCAnLScpO1xuICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihkb21zdHJpbmdzLnBlcmNlbnRhZ2UpLnRleHRDb250ZW50ID0gb2JqLnBlcmNlbnRhZ2U7XG4gICAgICAgIH0sXG4gICAgICAgIGRpc3BsYXlQZXJjZW50YWdlczogKHBlcmNlbnRhZ2UpPT57XG4gICAgICAgICAgICBsZXQgbGlzdFBlcmMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGRvbXN0cmluZ3MuaXRlbV9wZXJjZSk7XG4gICAgICAgICAgICBjb25zdCBub2RlTGlzdEZvckVhY2ggPSAobGlzdCwgY2FsbGJhY2spID0+IHtcbiAgICAgICAgICAgICAgICBmb3IobGV0IGkgPTA7IGkgPCBsaXN0Lmxlbmd0aDsgaSsrKXtcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2sobGlzdFtpXSwgaSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbm9kZUxpc3RGb3JFYWNoKGxpc3RQZXJjLCAoY3VycmVudCwgaW5kZXgpPT57XG4gICAgICAgICAgICAgICAgY3VycmVudC50ZXh0Q29udGVudCA9IHBlcmNlbnRhZ2VbaW5kZXhdICsgJyUnOyBcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH1cbiAgICB9XG59KSgpO1xuY29uc3QgY29udHJvbGxlciA9ICgoYnVkZ2V0Q3RybCwgdWlDdHJsKSA9PiB7XG4gICAgbGV0IERvbSA9IHVpQ3RybC5nbG9iYWxJbnB1dCgpO1xuXG4gICAgY29uc3QgdXBkYXRlQnVkZ2V0ID0gKCkgPT4ge1xuICAgICAgICBsZXQgYnVkZ2V0O1xuICAgICAgICBidWRnZXRDdHJsLmNhbGN1bGF0ZUJ1ZGdldCgpO1xuICAgICAgICBidWRnZXQgPSBidWRnZXRDdHJsLmdldEJ1ZGdldCgpO1xuXG4gICAgICAgIHVpQ3RybC5kaXNwbGF5QnVkZ2V0KGJ1ZGdldCk7XG4gICAgfTtcblxuICAgIGNvbnN0IHVwZGF0ZVBlcmNlbnRhZ2VzID0gKCkgPT57XG5cbiAgICAgICAgLy8gMS4gQ2FsYyBwZXJjbmV0YWdlc1xuICAgICAgICBidWRnZXRDdHJsLmNhbGN1bGF0ZVBlcmNlbnRhZ2VzKCk7XG5cbiAgICAgICAgLy8gMi4gUmVhZCBwZXJjbmV0YWdlc1xuICAgICAgICBsZXQgcGVyYyA9IGJ1ZGdldEN0cmwuZ2V0UGVyY2VudGFnZXMoKTtcbiAgICAgICAgLy8gMy4gRGlzcGxheSBhdCB0aGUgVUlcblxuICAgICAgICBjb25zb2xlLmxvZyhwZXJjICsgJyBlJyk7XG4gICAgICAgIHVpQ3RybC5kaXNwbGF5UGVyY2VudGFnZXMocGVyYyk7XG5cbiAgICB9O1xuICBcbiAgICBjb25zdCBjb25zdHJvbGxEZWxldGVJdGVtID0gKGUpPT57XG4gICAgICAgIGxldCBpdGVtLCBzcGxpdGVkSXRlbSwgdHlwZSwgSUQ7XG4gICAgICAgIGl0ZW0gPSBlLnRhcmdldC5wYXJlbnROb2RlLnBhcmVudE5vZGUucGFyZW50Tm9kZS5wYXJlbnROb2RlLmlkO1xuICAgICAgICBpZihpdGVtKXtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgc3BsaXRlZEl0ZW0gPSBpdGVtLnNwbGl0KCctJyk7XG4gICAgICAgICAgICB0eXBlID0gc3BsaXRlZEl0ZW1bMF07XG4gICAgICAgICAgICBJRCA9ICBwYXJzZUZsb2F0KHNwbGl0ZWRJdGVtWzFdKTtcblxuICAgICAgICAgICAgYnVkZ2V0Q3RybC5kZWxldGVJdGVtKHR5cGUsIElEKTtcbiAgICAgICAgICAgIC8vIHVwZGF0ZVBlcmNlbnRhZ2VzKCk7XG5cbiAgICAgICAgICAgIHVwZGF0ZUJ1ZGdldCgpO1xuICAgICAgICAgICAgXG4gICAgICAgIFxuICAgICAgICB9XG4gICAgfTtcbiAgICBjb25zdCBjb250cm9sQWRkSXRlbSA9ICgpID0+IHtcbiAgICAgICAgbGV0IGlucHV0LCBuZXdJdGVtO1xuICAgICAgICBpbnB1dCA9IHVpQ3RybC5pbnB1dFZhbHMoKTtcbiAgICAgICAgaWYoaW5wdXQuZ2V0RGVzYyAhPT0gJycgJiYgIWlzTmFOKGlucHV0LmdldFZhbHVlKSl7XG4gICAgICAgICAgICBuZXdJdGVtID0gYnVkZ2V0Q3RybC5hZGRJdGVtKGlucHV0LmdldFR5cGUsIGlucHV0LmdldERlc2MsIGlucHV0LmdldFZhbHVlKTtcbiAgICAgICAgICAgIHVpQ3RybC5hZGRJdGVtKGlucHV0LmdldFR5cGUsIG5ld0l0ZW0pO1xuICAgICAgICAgICAgdXBkYXRlQnVkZ2V0KCk7XG4gICAgICAgICAgICB1cGRhdGVQZXJjZW50YWdlcygpO1xuICAgICAgICB9ZWxzZSB7XG4gICAgICAgICAgICBhbGVydChgSGV5LCB0aGlzIGlzIG5vdCBPa2ApO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBjb25zdCBldnRMaXN0ZW5lcnMgPSAoKSA9PiB7XG4gICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoRG9tLmJ0bikuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBjb250cm9sQWRkSXRlbSk7XG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlwcmVzc1wiLCBlID0+IHtcbiAgICAgICAgICAgIGlmIChlLmtleWNvZGUgPT09IDEzIHx8IGUud2hpY2ggPT09IDEzKSB7XG4gICAgICAgICAgICAgICAgY29udHJvbEFkZEl0ZW0oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIGRlYnVnZ2VyO1xuICAgICAgICBidWRnZXRDdHJsLnRlc3RpbmdzKCk7XG5cbiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihEb20uY29udGFpbmVyKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGNvbnN0cm9sbERlbGV0ZUl0ZW0pO1xuICAgIH07XG4gICBcbiAgICByZXR1cm4ge1xuICAgICAgICBpbml0OiAoKSA9PiB7XG4gICAgICAgICAgICBldnRMaXN0ZW5lcnMoKTtcbiAgICAgICAgICAgIHVpQ3RybC5kaXNwbGF5QnVkZ2V0KHtcbiAgICAgICAgICAgICAgICBpbmNMYWJsZTogMCxcbiAgICAgICAgICAgICAgICBleHBMYWJsZTogMCxcbiAgICAgICAgICAgICAgICBidWRnZXQ6IDAsXG4gICAgICAgICAgICAgICAgcGVyY2VudGFnZTogMFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9O1xufSkoYnVkZ2V0Q29udHJvbGxlciwgdWlDb250cm9sbGVyKTtcbmNvbnRyb2xsZXIuaW5pdCgpO1xuXG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=

"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var budgetController=function(){var l=function e(t,n,i){_classCallCheck(this,e),this.id=t,this.description=n,this.value=i,this.percentages=-1};l.prototype.calcPercentages=function(e){0<e?(console.log(void 0===e?"undefined":_typeof(e)),console.log((void 0).value),(void 0).percentages=Math.round((void 0).value/e*100)):(void 0).percentages=-1},l.prototype.getPercentages=function(){return(void 0).percentages};var a=function e(t,n,i){_classCallCheck(this,e),this.id=t,this.description=n,this.value=i},e=function(e){var t=0;c.allItems[e].forEach(function(e){return t+=e.value}),c.totais[e]=t},c={allItems:{inc:[],exp:[]},totais:{exp:0,inc:0},budget:0,percentage:-1};return{addItem:function(e,t,n){var i=void 0,o=void 0;return o=0<c.allItems[e].length?c.allItems[e][c.allItems[e].length-1].id+1:0,"inc"===e?i=new a(o,t,n):"exp"===e&&(i=new l(o,t,n)),c.allItems[e].push(i),i},calculateBudget:function(){e("inc"),e("exp"),c.budget=c.totais.inc-c.totais.exp,0<c.totais.inc?c.percentage=Math.round(c.totais.exp/c.totais.inc*100):c.percentage=-1},getBudget:function(){return{budget:c.budget,labelInc:c.totais.inc,labelExp:c.totais.exp,percentage:c.percentage}},testings:function(){console.log(c)},deleteItem:function(e,t){var n;-1!==(n=c.allItems[t].map(function(e){return e.id}).indexOf(e))&&c.allItems[t].splice(n,1)},calculatePercentages:function(){c.allItems.exp.forEach(function(e){return e.calcPercentages(c.totais.inc)})},getPercentages:function(){return c.allItems.exp.map(function(e){return e.getPercentages()})}}}(),uiController=function(){var l={type:".add__type",desc:".add__description",value:".add__value",btn:".add__btn",incList:".income__list",expList:".expenses__list",container:".container",budget:".budget__value",income_lable:".budget__income--value",expense_lable:".budget__expenses--value",month:".budget__title--month",percentage:".budget__expenses--percentage"},a=function(e,t){var n,i,o;return n=(o=(e=(e=Math.abs(e)).toFixed(2)).split("."))[0],i=o[1],console.log(n.substr(0,n.length-3)),3<n.length&&(n=n.substr(0,n.length-3)+"."+n.substr(n.length-3,3)),("inc"===t?"+":"-")+" "+n+","+i};return{inputVals:function(){return{getType:document.querySelector(l.type).value,getDesc:document.querySelector(l.desc).value,getValue:parseInt(document.querySelector(l.value).value)}},globlaStrings:function(){return l},clearFields:function(e,t){document.querySelectorAll(e+","+t).forEach(function(e){e.value=""})},addItem:function(e,t){var n=void 0,i=void 0,o=void 0;"inc"===t?(o=l.incList,n='<div class="item clearfix" id="inc-%id%"> <div class="item__description"> %desc%</div> <div class="right clearfix"> <div class="item__value">%val%</div> <div class="item__delete"> <button class="item__delete--btn"><i class="ion-ios-close-outline"></i></button> </div> </div> </div>'):"exp"===t&&(o=l.expList,n='<div class="item clearfix" id="exp-%id%"> <div class="item__description"> %desc%</div> <div class="right clearfix"> <div class="item__value">%val%</div> <div class="item__percentage">21%</div> <div class="item__delete"> <button class="item__delete--btn"><i class="ion-ios-close-outline"></i></button> </div> </div> </div>'),i=(i=(i=n.replace("%id%",e.id)).replace("%desc%",e.description)).replace("%val%",a(e.value,t)),document.querySelector(o).insertAdjacentHTML("beforeend",i)},displayBudget:function(e){e.budget,document.querySelector(l.budget).textContent=a(e.budget,void 0),document.querySelector(l.income_lable).textContent=a(e.labelInc,"+"),document.querySelector(l.expense_lable).textContent=a(e.labelExp,"-"),document.querySelector(l.percentage).textContent=e.percentage},deleteItem:function(e){var t=document.getElementById(e);t.parentNode.removeChild(t)},formatingDate:function(){var e,t,n,i=void 0;e=(i=new Date).getDay(),t=i.getMonth(),n=["January","February","March","April","May","June","July","August","September","October","November","December"],document.querySelector(l.month).textContent=e+" "+n[t]}}}(),controller=function(l,a){var n=a.globlaStrings(),c=function(){l.calculateBudget();var e=l.getBudget();a.displayBudget(e)},e=function(e){var t=void 0,n=void 0,i=void 0,o=void 0;(t=e.target.parentNode.parentNode.parentNode.parentNode.id)&&(o=(n=t.split("-"))[0],i=parseFloat(n[1]),l.deleteItem(i,o),c(),a.deleteItem(t))},t=function(){var e,t=void 0;" "!==(e=a.inputVals()).getDesc&&!isNaN(e.getValue)||0<e.getValue?(t=l.addItem(e.getType,e.getDesc,e.getValue),a.addItem(t,e.getType),a.clearFields(n.desc,n.value),c(),console.log("SIM NESSA PORRA")):console.log("Nada nesse caralho")};return{init:function(){document.querySelector(n.btn).addEventListener("click",t),document.addEventListener("keypress",function(e){13!==e.keyCode&&13!==e.which||t()}),document.querySelector(n.container).addEventListener("click",e),a.displayBudget({budget:0,labelInc:0,labelExp:0,percentage:0}),a.formatingDate()}}}(budgetController,uiController);controller.init();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6WyJidWRnZXRDb250cm9sbGVyIiwiRXhwZW5zZSIsImlkIiwiZGVzY3JpcHRpb24iLCJ2YWx1ZSIsIl9jbGFzc0NhbGxDaGVjayIsInRoaXMiLCJwZXJjZW50YWdlcyIsInByb3RvdHlwZSIsInRvdGFsSW5jb21lIiwiY29uc29sZSIsImxvZyIsIl90eXBlb2YiLCJ1bmRlZmluZWQiLCJjYWxjUGVyY2VudGFnZXMiLCJnZXRQZXJjZW50YWdlcyIsIkluY29tZSIsImNhbGNCdWRnZXQiLCJzdW0iLCJkYXRhIiwiYWxsSXRlbXMiLCJ0eXBlIiwiZm9yRWFjaCIsImVyciIsInRvdGFpcyIsImluYyIsImV4cCIsImJ1ZGdldCIsInBlcmNlbnRhZ2UiLCJuZXdpdGVtIiwiSUQiLCJhZGRJdGVtIiwibGVuZ3RoIiwiY2FsY3VsYXRlQnVkZ2V0IiwiZ2V0QnVkZ2V0IiwibGFiZWxJbmMiLCJsYWJlbEV4cCIsImRlbGV0ZUl0ZW0iLCJ0ZXN0aW5ncyIsIml0ZW0iLCJpbmRleCIsIm1hcCIsImN1cnIiLCJpbmRleE9mIiwiY2FsY3VsYXRlUGVyY2VudGFnZXMiLCJ1aUNvbnRyb2xsZXIiLCJkb21zdHJpbmdzIiwiZGVzYyIsImJ0biIsImluY0xpc3QiLCJleHBMaXN0IiwiY29udGFpbmVyIiwibW9udGgiLCJudW0iLCJkZWMiLCJzcGxpdE51bSIsImludCIsImZvcm1hdGluZ051bWJlcnMiLCJNYXRoIiwiYWJzIiwidG9GaXhlZCIsInNwbGl0Iiwic3Vic3RyIiwiaW5wdXRWYWxzIiwiZ2V0VHlwZSIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImdldERlc2MiLCJnbG9ibGFTdHJpbmdzIiwiY2xlYXJGaWVsZHMiLCJxdWVyeVNlbGVjdG9yQWxsIiwib2JqIiwiaHRtbCIsIm5ld0h0bWwiLCJlbGVtZW50IiwicmVwbGFjZSIsImRpc3BsYXlCdWRnZXQiLCJ0ZXh0Q29udGVudCIsImluY29tZV9sYWJsZSIsImV4cGVuc2VfbGFibGUiLCJnZXRFbGVtZW50QnlJZCIsImVsIiwicGFyZW50Tm9kZSIsInJlbW92ZUNoaWxkIiwiZm9ybWF0aW5nRGF0ZSIsImRheSIsIm1vbnRocyIsIm5vdyIsIkRhdGUiLCJnZXREYXkiLCJnZXRNb250aCIsIkRvbSIsInVpQ3RybCIsInVwZGF0ZUJ1ZGdldCIsImJ1ZGdldEN0cmwiLCJjb250cm9sbGVyIiwiY29udHJvbERlbGV0ZUl0ZW0iLCJlIiwic3BsaXRJdGVtIiwidGFyZ2V0IiwiYWRkRXZlbnRMaXN0ZW5lciIsImlucHV0IiwiZXZ0IiwiY29udHJvbEFkZEl0ZW1zIiwiaXNOYU4iLCJnZXRWYWx1ZSIsIm5ld0l0ZW0iLCJpbml0Iiwia2V5Q29kZSIsIndoaWNoIiwiZXZlbnRMaXN0ZW5uZXJzIl0sIm1hcHBpbmdzIjoiK1VBRUEsSUFBTUEsaUJBQW9CLFdBQUssSUFFckJDLEVBQ0YsU0FBQUEsRUFBWUMsRUFBSUMsRUFBYUMsR0FBTUMsZ0JBQUFDLEtBQUFMLEdBSHJDRCxLQUFBQSxHQUFBQSxFQUVJQyxLQUZxQkUsWUFHdkJBLEVBQW1DRyxLQUFBRixNQUFBQSxFQUkvQkUsS0FBS0MsYUFBZSxHQURwQk4sRUFBQU8sVUFBYUosZ0JBQWIsU0FBQUssR0FDQSxFQUFBQSxHQVBtQkMsUUFBQUMsU0FBQSxJQUFBRixFQUFBLFlBQUFHLFFBQUFILElBYW5CQyxRQUFRQyxVQUFJRSxHQUFLVCxhQUhqQkksR0FBQUEsWUFBVU0sS0FBQUEsWUFBa0JELEdBQUFULE1BQUNLLEVBQWMsWUFFM0NDLEdBQUFBLGFBQW1CRCxHQUd0QlIsRUFKRE8sVUFJS08sZUFBQSxXQUNELFlBQUFGLEdBQUFOLGFBaEJtQixJQVUzQlMsRUFTQWYsU0FBQUEsRUFBUU8sRUFBVU8sRUFBbEJYLEdBQW1DQyxnQkFBQUMsS0FBQVUsR0FDL0JWLEtBQU9KLEdBQUFBLEVBRFhJLEtBQUFILFlBQUFBLEVBT1FHLEtBQUtGLE1BQVFBLEdBQWJhLEVBQWFiLFNBQUFBLEdBMUJNLElBQUFjLEVBQUEsRUFrQ3ZCQyxFQUFLQyxTQUFTQyxH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U0FBQVUsR0FDQSxLQUFBQSxFQUFBTSxTQUFBLEtBQUFOLEVBQUFPLE9BQ0hOLE1BR0NPLFNBQUFBLGNBQWtCbkIsRUFBbEJtQixXQUFBQSxpQkFBc0IsUUFBQWQsR0FxQnBCdEYsRUFBQUEsY0FBWSxDQUNmaUIsT0FBQSxFQWJMUSxTQUFBLEVBaUJNQyxTQUFBLEVBQ0dSLFdBQUEsSUFFRGdFLEVBQU9oQixrQkFqRUhYLENBcUVGckMsaUJBQUFBLGNBSm1CbUUsV0FBQVkiLCJmaWxlIjoiYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsiXG5cbmNvbnN0IGJ1ZGdldENvbnRyb2xsZXIgPSAoKCkgPT57XG5cbiAgICBjbGFzcyBFeHBlbnNle1xuICAgICAgICBjb25zdHJ1Y3RvcihpZCwgZGVzY3JpcHRpb24sIHZhbHVlKXtcbiAgICAgICAgICAgIHRoaXMuaWQgPSBpZDtcbiAgICAgICAgICAgIHRoaXMuZGVzY3JpcHRpb24gPSBkZXNjcmlwdGlvbjtcbiAgICAgICAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgICAgIHRoaXMucGVyY2VudGFnZXMgPSAtMTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBFeHBlbnNlLnByb3RvdHlwZS5jYWxjUGVyY2VudGFnZXMgPSAodG90YWxJbmNvbWUpPT57XG4gICAgICAgIGlmICh0b3RhbEluY29tZSA+IDApe1xuICAgICAgICAgICAgY29uc29sZS5sb2codHlwZW9mIHRvdGFsSW5jb21lKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHRoaXMudmFsdWUpO1xuICAgICAgICAgICAgdGhpcy5wZXJjZW50YWdlcyA9IE1hdGgucm91bmQoKHRoaXMudmFsdWUgLyB0b3RhbEluY29tZSkgKiAxMDApO1xuICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgIHRoaXMucGVyY2VudGFnZXMgPSAtMTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgRXhwZW5zZS5wcm90b3R5cGUuZ2V0UGVyY2VudGFnZXMgPSAoKT0+e1xuICAgICAgICByZXR1cm4gdGhpcy5wZXJjZW50YWdlcztcbiAgICB9O1xuICAgIGNsYXNzIEluY29tZXtcbiAgICAgICAgY29uc3RydWN0b3IoaWQsIGRlc2NyaXB0aW9uLCB2YWx1ZSl7XG4gICAgICAgICAgICB0aGlzLmlkID0gaWQ7XG4gICAgICAgICAgICB0aGlzLmRlc2NyaXB0aW9uID0gZGVzY3JpcHRpb247XG4gICAgICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBcblxuICAgIGNvbnN0IGNhbGNCdWRnZXQgPSAodHlwZSk9PntcbiAgICAgICAgbGV0IHN1bSA9IDA7XG4gICAgICAgIGRhdGEuYWxsSXRlbXNbdHlwZV0uZm9yRWFjaChlcnI9PntcbiAgICAgICAgICAgIHJldHVybiBzdW0gKz0gZXJyLnZhbHVlO1xuICAgICAgICB9KTtcbiAgICAgICAgZGF0YS50b3RhaXNbdHlwZV0gPSBzdW07XG4gICAgfTtcbiAgICBsZXQgZGF0YT17XG4gICAgICAgIGFsbEl0ZW1zOntcbiAgICAgICAgICAgIGluYzogW10sXG4gICAgICAgICAgICBleHA6IFtdXG4gICAgICAgIH0sXG4gICAgICAgIHRvdGFpczp7XG4gICAgICAgICAgICBleHA6IDAsXG4gICAgICAgICAgICBpbmM6IDBcbiAgICAgICAgfSxcbiAgICAgICAgYnVkZ2V0OiAwLFxuICAgICAgICBwZXJjZW50YWdlOiAtMVxuICAgIH07XG4gICAgcmV0dXJue1xuICAgICAgICBhZGRJdGVtOiAodHlwZSwgZGVzY3JpcHRpb24sIHZhbHVlKT0+e1xuICAgICAgICAgICAgbGV0IG5ld2l0ZW0sIElEO1xuICAgICAgICAgICAgaWYoZGF0YS5hbGxJdGVtc1t0eXBlXS5sZW5ndGggPiAwKXtcbiAgICAgICAgICAgICAgICBJRCA9IGRhdGEuYWxsSXRlbXNbdHlwZV1bZGF0YS5hbGxJdGVtc1t0eXBlXS5sZW5ndGggLSAxXS5pZCArIDE7XG4gICAgICAgICAgICB9ZWxzZSB7XG4gICAgICAgICAgICAgICAgSUQgPSAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYodHlwZSA9PT0gJ2luYycpe1xuICAgICAgICAgICAgICAgIG5ld2l0ZW0gPSBuZXcgSW5jb21lKElELCBkZXNjcmlwdGlvbiwgdmFsdWUpO1xuICAgICAgICAgICAgfWVsc2UgaWYodHlwZSA9PT0gJ2V4cCcpe1xuICAgICAgICAgICAgICAgIG5ld2l0ZW0gPSBuZXcgRXhwZW5zZShJRCwgZGVzY3JpcHRpb24sIHZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGRhdGEuYWxsSXRlbXNbdHlwZV0ucHVzaChuZXdpdGVtKTtcbiAgICAgICAgICAgIHJldHVybiBuZXdpdGVtO1xuICAgICAgICB9LFxuICAgICAgICBjYWxjdWxhdGVCdWRnZXQ6ICgpPT57XG4gICAgICAgICAgICAvLyBjYWxjYXRvdGFsc1xuICAgICAgICAgICAgY2FsY0J1ZGdldCgnaW5jJyk7XG4gICAgICAgICAgICBjYWxjQnVkZ2V0KCdleHAnKTtcblxuICAgICAgICAgICAgLy8gY2FsYyBidWRnZXRcbiAgICAgICAgICAgIGRhdGEuYnVkZ2V0ID0gZGF0YS50b3RhaXMuaW5jIC0gZGF0YS50b3RhaXMuZXhwO1xuXG4gICAgICAgICAgICAvLyBjYWxjIHBlcmNlbnRhZ2VcbiAgICAgICAgICAgIGlmKGRhdGEudG90YWlzLmluYyA+IDApe1xuICAgICAgICAgICAgICAgIGRhdGEucGVyY2VudGFnZSA9IE1hdGgucm91bmQoKGRhdGEudG90YWlzLmV4cCAvIGRhdGEudG90YWlzLmluYykgKiAxMDApO1xuICAgICAgICAgICAgfWVsc2Uge1xuICAgICAgICAgICAgICAgIGRhdGEucGVyY2VudGFnZSA9IC0xO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBnZXRCdWRnZXQ6ICgpPT57XG4gICAgICAgICAgICByZXR1cm57XG4gICAgICAgICAgICAgICAgYnVkZ2V0OiBkYXRhLmJ1ZGdldCxcbiAgICAgICAgICAgICAgICBsYWJlbEluYzogZGF0YS50b3RhaXMuaW5jLFxuICAgICAgICAgICAgICAgIGxhYmVsRXhwOiBkYXRhLnRvdGFpcy5leHAsXG4gICAgICAgICAgICAgICAgcGVyY2VudGFnZTogZGF0YS5wZXJjZW50YWdlXG4gICAgICAgICAgICB9O1xuICAgICAgICB9LFxuICAgICAgICB0ZXN0aW5nczooKT0+e1xuICAgICAgICAgICAgY29uc29sZS5sb2coZGF0YSk7XG4gICAgICAgIH0sXG4gICAgICAgIGRlbGV0ZUl0ZW06IChJRCwgdHlwZSk9PntcbiAgICAgICAgICAgIGxldCBpbmRleCwgaXRlbTtcbiAgICAgICAgICAgIGl0ZW0gPSBkYXRhLmFsbEl0ZW1zW3R5cGVdLm1hcChjdXJyPT57XG4gICAgICAgICAgICAgICAgcmV0dXJuIGN1cnIuaWQ7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGluZGV4ID0gaXRlbS5pbmRleE9mKElEKTtcbiAgICAgICAgICAgIGlmIChpbmRleCAhPT0gLTEpe1xuICAgICAgICAgICAgICAgIGRhdGEuYWxsSXRlbXNbdHlwZV0uc3BsaWNlKGluZGV4LCAxKTsgXG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGNhbGN1bGF0ZVBlcmNlbnRhZ2VzOiAoKT0+e1xuICAgICAgICAgICAgZGF0YS5hbGxJdGVtcy5leHAuZm9yRWFjaChjdXJyPT57XG4gICAgICAgICAgICAgICAgcmV0dXJuIGN1cnIuY2FsY1BlcmNlbnRhZ2VzKGRhdGEudG90YWlzLmluYyk7XG4gICAgICAgICAgICB9KTsgXG4gICAgICAgIH0sXG4gICAgICAgIGdldFBlcmNlbnRhZ2VzOiAoKT0+e1xuICAgICAgICAgICAgbGV0IHBlcmNlID0gZGF0YS5hbGxJdGVtcy5leHAubWFwKGN1cnI9PntcbiAgICAgICAgICAgICAgICByZXR1cm4gY3Vyci5nZXRQZXJjZW50YWdlcygpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gcGVyY2U7XG4gICAgICAgIH1cbiAgICB9O1xufSkoKTtcblxuXG5jb25zdCB1aUNvbnRyb2xsZXIgPSAoKCk9PntcbiAgICAgICAgbGV0IGRvbXN0cmluZ3MgPSB7XG4gICAgICAgICAgICB0eXBlOiBcIi5hZGRfX3R5cGVcIixcbiAgICAgICAgICAgIGRlc2M6IFwiLmFkZF9fZGVzY3JpcHRpb25cIixcbiAgICAgICAgICAgIHZhbHVlOiBcIi5hZGRfX3ZhbHVlXCIsXG4gICAgICAgICAgICBidG46IFwiLmFkZF9fYnRuXCIsXG4gICAgICAgICAgICBpbmNMaXN0OiBcIi5pbmNvbWVfX2xpc3RcIixcbiAgICAgICAgICAgIGV4cExpc3Q6IFwiLmV4cGVuc2VzX19saXN0XCIsXG4gICAgICAgICAgICBjb250YWluZXI6IFwiLmNvbnRhaW5lclwiLFxuICAgICAgICAgICAgYnVkZ2V0OiBcIi5idWRnZXRfX3ZhbHVlXCIsXG4gICAgICAgICAgICBpbmNvbWVfbGFibGU6IFwiLmJ1ZGdldF9faW5jb21lLS12YWx1ZVwiLFxuICAgICAgICAgICAgZXhwZW5zZV9sYWJsZTogXCIuYnVkZ2V0X19leHBlbnNlcy0tdmFsdWVcIixcbiAgICAgICAgICAgIG1vbnRoOiBcIi5idWRnZXRfX3RpdGxlLS1tb250aFwiLFxuICAgICAgICAgICAgcGVyY2VudGFnZTogXCIuYnVkZ2V0X19leHBlbnNlcy0tcGVyY2VudGFnZVwiLFxuXG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IGZvcm1hdGluZ051bWJlcnMgPSAobnVtLCB0eXBlKT0+e1xuICAgICAgICAgICAgdmFyIGludCwgZGVjLCBzcGxpdE51bSwgdHlwZTtcbiAgICAgICAgICAgIG51bSA9IE1hdGguYWJzKG51bSk7XG4gICAgICAgICAgICBudW0gPSBudW0udG9GaXhlZCgyKTtcbiAgICAgICAgICAgIHNwbGl0TnVtID0gbnVtLnNwbGl0KCcuJyk7XG4gICAgICAgICAgICBpbnQgPSBzcGxpdE51bVswXTtcbiAgICAgICAgICAgIGRlYyA9IHNwbGl0TnVtWzFdO1xuICAgICAgICAgICAgY29uc29sZS5sb2coaW50LnN1YnN0cigwLCBpbnQubGVuZ3RoIC0gMykpO1xuICAgICAgICAgICAgaWYoaW50Lmxlbmd0aCA+IDMpe1xuICAgICAgICAgICAgICAgIGludCA9IGludC5zdWJzdHIoMCwgaW50Lmxlbmd0aCAtIDMpICsgJy4nICArICBpbnQuc3Vic3RyKGludC5sZW5ndGggLTMsIDMpOyBcbiAgICAgICAgICAgIH0gXG4gICAgICAgICAgIHJldHVybiAodHlwZSA9PT0gJ2luYycgPyAnKycgOiAnLScpICsgJyAnICsgaW50ICsgJywnICsgZGVjOyBcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgXG4gICAgICAgIH07XG4gICAgICAgIHJldHVybntcbiAgICAgICAgICAgIGlucHV0VmFsczogKCk9PntcbiAgICAgICAgICAgICAgICByZXR1cm57XG4gICAgICAgICAgICAgICAgICAgIGdldFR5cGU6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoZG9tc3RyaW5ncy50eXBlKS52YWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgZ2V0RGVzYzogZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihkb21zdHJpbmdzLmRlc2MpLnZhbHVlLFxuICAgICAgICAgICAgICAgICAgICBnZXRWYWx1ZTogcGFyc2VJbnQoZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihkb21zdHJpbmdzLnZhbHVlKS52YWx1ZSlcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGdsb2JsYVN0cmluZ3M6KCk9PntcbiAgICAgICAgICAgICAgICByZXR1cm4gZG9tc3RyaW5ncztcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBjbGVhckZpZWxkczooZGVzYywgdmFsdWUpPT57XG4gICAgICAgICAgICAgICAgbGV0IGl0ZW0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGRlc2MgKyBcIixcIiArIHZhbHVlKTtcbiAgICAgICAgICAgICAgICBpdGVtLmZvckVhY2goY3Vycj0+e1xuICAgICAgICAgICAgICAgICAgICBjdXJyLnZhbHVlID0gJyc7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgYWRkSXRlbTogKG9iaiwgdHlwZSk9PntcbiAgICAgICAgICAgICAgICBsZXQgaHRtbCwgbmV3SHRtbCwgZWxlbWVudDtcbiAgICAgICAgICAgICAgICBpZih0eXBlID09PSAnaW5jJyl7XG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnQgPSBkb21zdHJpbmdzLmluY0xpc3Q7XG4gICAgICAgICAgICAgICAgICAgIGh0bWwgPSAnPGRpdiBjbGFzcz1cIml0ZW0gY2xlYXJmaXhcIiBpZD1cImluYy0laWQlXCI+IDxkaXYgY2xhc3M9XCJpdGVtX19kZXNjcmlwdGlvblwiPiAlZGVzYyU8L2Rpdj4gPGRpdiBjbGFzcz1cInJpZ2h0IGNsZWFyZml4XCI+IDxkaXYgY2xhc3M9XCJpdGVtX192YWx1ZVwiPiV2YWwlPC9kaXY+IDxkaXYgY2xhc3M9XCJpdGVtX19kZWxldGVcIj4gPGJ1dHRvbiBjbGFzcz1cIml0ZW1fX2RlbGV0ZS0tYnRuXCI+PGkgY2xhc3M9XCJpb24taW9zLWNsb3NlLW91dGxpbmVcIj48L2k+PC9idXR0b24+IDwvZGl2PiA8L2Rpdj4gPC9kaXY+JztcbiAgICAgICAgICAgICAgICB9ZWxzZSBpZih0eXBlID09PSAnZXhwJyl7XG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnQgPSBkb21zdHJpbmdzLmV4cExpc3Q7XG4gICAgICAgICAgICAgICAgICAgIGh0bWwgPSAnPGRpdiBjbGFzcz1cIml0ZW0gY2xlYXJmaXhcIiBpZD1cImV4cC0laWQlXCI+IDxkaXYgY2xhc3M9XCJpdGVtX19kZXNjcmlwdGlvblwiPiAlZGVzYyU8L2Rpdj4gPGRpdiBjbGFzcz1cInJpZ2h0IGNsZWFyZml4XCI+IDxkaXYgY2xhc3M9XCJpdGVtX192YWx1ZVwiPiV2YWwlPC9kaXY+IDxkaXYgY2xhc3M9XCJpdGVtX19wZXJjZW50YWdlXCI+MjElPC9kaXY+IDxkaXYgY2xhc3M9XCJpdGVtX19kZWxldGVcIj4gPGJ1dHRvbiBjbGFzcz1cIml0ZW1fX2RlbGV0ZS0tYnRuXCI+PGkgY2xhc3M9XCJpb24taW9zLWNsb3NlLW91dGxpbmVcIj48L2k+PC9idXR0b24+IDwvZGl2PiA8L2Rpdj4gPC9kaXY+JztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgbmV3SHRtbCA9IGh0bWwucmVwbGFjZShcIiVpZCVcIiwgb2JqLmlkKTtcbiAgICAgICAgICAgICAgICBuZXdIdG1sID0gbmV3SHRtbC5yZXBsYWNlKFwiJWRlc2MlXCIsIG9iai5kZXNjcmlwdGlvbik7XG4gICAgICAgICAgICAgICAgbmV3SHRtbCA9IG5ld0h0bWwucmVwbGFjZShcIiV2YWwlXCIsIGZvcm1hdGluZ051bWJlcnMob2JqLnZhbHVlLCB0eXBlKSk7XG4gICAgICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihlbGVtZW50KS5pbnNlcnRBZGphY2VudEhUTUwoJ2JlZm9yZWVuZCcsIG5ld0h0bWwpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGRpc3BsYXlCdWRnZXQ6IChvYmopPT57XG4gICAgICAgICAgICAgICAgbGV0IHR5cGU7XG4gICAgICAgICAgICAgICAgb2JqLmJ1ZGdldCA+IDAgPyAnKycgOiAnLSc7XG4gICAgICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihkb21zdHJpbmdzLmJ1ZGdldCkudGV4dENvbnRlbnQgPSBmb3JtYXRpbmdOdW1iZXJzKG9iai5idWRnZXQsIHR5cGUpO1xuICAgICAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoZG9tc3RyaW5ncy5pbmNvbWVfbGFibGUpLnRleHRDb250ZW50ID0gZm9ybWF0aW5nTnVtYmVycyhvYmoubGFiZWxJbmMsICcrJyk7XG4gICAgICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihkb21zdHJpbmdzLmV4cGVuc2VfbGFibGUpLnRleHRDb250ZW50ID0gZm9ybWF0aW5nTnVtYmVycyhvYmoubGFiZWxFeHAsIFwiLVwiKTtcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGRvbXN0cmluZ3MucGVyY2VudGFnZSkudGV4dENvbnRlbnQgPSBvYmoucGVyY2VudGFnZTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBkZWxldGVJdGVtOiAoaXRlbSk9PntcbiAgICAgICAgICAgICAgICBsZXQgZWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpdGVtKTtcbiAgICAgICAgICAgICAgICBlbC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGVsKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBmb3JtYXRpbmdEYXRlOigpPT57XG4gICAgICAgICAgICAgICAgbGV0IG5vdywgZGF5LCBtb250aCwgbW9udGhzO1xuICAgICAgICAgICAgICAgIG5vdyA9IG5ldyBEYXRlKCk7XG4gICAgICAgICAgICAgICAgZGF5ICA9ICBub3cuZ2V0RGF5KCk7XG4gICAgICAgICAgICAgICAgbW9udGggPSBub3cuZ2V0TW9udGgoKTtcbiAgICAgICAgICAgICAgICBtb250aHMgPSBbJ0phbnVhcnknLCAnRmVicnVhcnknLCAnTWFyY2gnLCAnQXByaWwnLCAnTWF5JywgJ0p1bmUnLCAnSnVseScsICdBdWd1c3QnLCAnU2VwdGVtYmVyJywgJ09jdG9iZXInLCAnTm92ZW1iZXInLCAnRGVjZW1iZXInXTtcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGRvbXN0cmluZ3MubW9udGgpLnRleHRDb250ZW50ID0gYCR7ZGF5fSAke21vbnRoc1ttb250aF19YDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICB9O1xuICAgIH1cbikoKTtcbmNvbnN0IGNvbnRyb2xsZXIgPSAoKGJ1ZGdldEN0cmwsIHVpQ3RybCk9PntcbiAgICBsZXQgRG9tID0gdWlDdHJsLmdsb2JsYVN0cmluZ3MoKTtcbiAgICBcbiAgICBjb25zdCB1cGRhdGVCdWRnZXQgPSAoKT0+e1xuICAgICAgICBidWRnZXRDdHJsLmNhbGN1bGF0ZUJ1ZGdldCgpO1xuICAgICAgICBsZXQgYnVkZ2V0ID0gYnVkZ2V0Q3RybC5nZXRCdWRnZXQoKTtcbiAgICAgICAgdWlDdHJsLmRpc3BsYXlCdWRnZXQoYnVkZ2V0KTtcblxuICAgIH07XG4gICAgLy8gY29uc3QgdXBkYXRlUGVyY2VudGFnZXMgPSAoKSA9PiB7XG4gICAgLy8gICBidWRnZXRDdHJsLmNhbGN1bGF0ZVBlcmNlbnRhZ2VzKCk7XG5cbiAgICAvLyAgIGxldCBwZXJjZSA9IGJ1ZGdldEN0cmwuZ2V0UGVyY2VudGFnZXMoKTtcbiAgICAvLyAgIGNvbnNvbGUubG9nKHBlcmNlKTtcbiAgICAvLyB9O1xuICAgIGNvbnN0IGNvbnRyb2xEZWxldGVJdGVtID0gKGUpPT57XG5cbiAgICAgICAgbGV0IGl0ZW0sIHNwbGl0SXRlbSwgSUQsIHR5cGU7XG4gICAgICAgIGl0ZW0gPSBlLnRhcmdldC5wYXJlbnROb2RlLnBhcmVudE5vZGUucGFyZW50Tm9kZS5wYXJlbnROb2RlLmlkO1xuICAgICAgICBpZiAoaXRlbSl7XG4gICAgICAgICAgICBzcGxpdEl0ZW0gPSBpdGVtLnNwbGl0KCctJyk7XG4gICAgICAgICAgICB0eXBlID0gc3BsaXRJdGVtWzBdO1xuICAgICAgICAgICAgSUQgPSBwYXJzZUZsb2F0KHNwbGl0SXRlbVsxXSk7XG4gICAgICAgICAgICBidWRnZXRDdHJsLmRlbGV0ZUl0ZW0oSUQsIHR5cGUpO1xuICAgICAgICAgICAgdXBkYXRlQnVkZ2V0KCk7XG4gICAgICAgICAgICB1aUN0cmwuZGVsZXRlSXRlbShpdGVtKTtcbiAgICAgICAgICAgIC8vIHVwZGF0ZVBlcmNlbnRhZ2VzKCk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgY29uc3QgZXZlbnRMaXN0ZW5uZXJzID0gKCk9PntcbiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihEb20uYnRuKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGNvbnRyb2xBZGRJdGVtcyk7XG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleXByZXNzJywgZXZ0PT57XG4gICAgICAgICAgICBpZihldnQua2V5Q29kZSA9PT0gMTMgfHwgZXZ0LndoaWNoID09PSAxMyl7XG4gICAgICAgICAgICAgICAgY29udHJvbEFkZEl0ZW1zKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKERvbS5jb250YWluZXIpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY29udHJvbERlbGV0ZUl0ZW0pO1xuICAgIH07XG4gICAgY29uc3QgY29udHJvbEFkZEl0ZW1zID0gKCk9PntcbiAgICAgICAgbGV0IGlucHV0LCBuZXdJdGVtO1xuICAgICAgICBpbnB1dCA9IHVpQ3RybC5pbnB1dFZhbHMoKTtcbiAgICAgICAgaWYoaW5wdXQuZ2V0RGVzYyAhPT0gJyAnICYmICFpc05hTihpbnB1dC5nZXRWYWx1ZSkgfHwgaW5wdXQuZ2V0VmFsdWUgPiAwKXtcbiAgICAgICAgICAgIG5ld0l0ZW0gPSBidWRnZXRDdHJsLmFkZEl0ZW0oaW5wdXQuZ2V0VHlwZSwgaW5wdXQuZ2V0RGVzYywgaW5wdXQuZ2V0VmFsdWUpO1xuICAgICAgICAgICAgdWlDdHJsLmFkZEl0ZW0obmV3SXRlbSwgaW5wdXQuZ2V0VHlwZSk7XG4gICAgICAgICAgICAvLyBDbGVhciBGaWVsZHNcbiAgICAgICAgICAgIHVpQ3RybC5jbGVhckZpZWxkcyhEb20uZGVzYywgRG9tLnZhbHVlKTtcbiAgICAgICAgICAgIHVwZGF0ZUJ1ZGdldCgpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJTSU0gTkVTU0EgUE9SUkFcIik7XG4gICAgICAgICAgICAvLyB1cGRhdGVQZXJjZW50YWdlcygpO1xuICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdOYWRhIG5lc3NlIGNhcmFsaG8nKTtcbiAgICAgICAgfVxuICAgICAgIFxuXG4gICAgfTtcbiAgICByZXR1cm57XG4gICAgICAgIGluaXQ6KCk9PntcbiAgICAgICAgICAgIGV2ZW50TGlzdGVubmVycygpO1xuICAgICAgICAgICAgdWlDdHJsLmRpc3BsYXlCdWRnZXQoe1xuICAgICAgICAgICAgICBidWRnZXQ6IDAsXG4gICAgICAgICAgICAgIGxhYmVsSW5jOiAwLFxuICAgICAgICAgICAgICBsYWJlbEV4cDogMCxcbiAgICAgICAgICAgICAgcGVyY2VudGFnZTogMFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB1aUN0cmwuZm9ybWF0aW5nRGF0ZSgpO1xuICAgICAgICB9XG4gICAgfVxufVxuKShidWRnZXRDb250cm9sbGVyLCB1aUNvbnRyb2xsZXIpO1xuY29udHJvbGxlci5pbml0KCk7XG5cbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==

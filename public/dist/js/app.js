"use strict";var _createClass=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var budgetController=function(){console.log("Budget");!function(){function i(e,t,n){_classCallCheck(this,i),this.id=e,this.description=t,this.value=n}_createClass(i,[{key:"calculatePercentages",value:function(e){this.percentages=e?Math.round(this.value/e*100):-1}},{key:"getPercentages",value:function(){return this.percentages}}])}();var c=function e(t,n,i){_classCallCheck(this,e),this.id=t,this.description=n,this.value=i},l={allItems:{inc:[],exp:[]},totals:{inc:0,exp:0},budget:0,percentage:-1},e=function(e){var t=0;return l.allItems[e].forEach(function(e){return t+=e.value}),l.totals[e]=t};return{addItem:function(e,t,n){var i=void 0,a=void 0;return i=0<l.allItems[e].length?l.allItems[e][l.allItems[e].length-1].id+1:0,"inc"===e?a=new c(i,t,n):"exp"===e&&(a=new c(i,t,n)),l.allItems[e].push(a),a},testings:function(){return l},calculateBudget:function(){e("inc"),e("exp"),l.budget=l.totals.inc-l.totals.exp,console.log(l.totals.inc),0<l.totals.inc?l.percentage=Math.round(l.totals.exp/l.totals.inc*100):l.percentage=-1},getBudget:function(){return{incLable:l.totals.inc,expLable:l.totals.exp,budget:l.budget,percentage:l.percentage}},deleteItem:function(e,t){var n;-1!==(n=l.allItems[e].map(function(e){return e.id}).indexOf(t))&&l.allItems[e].splice(n,1)},calculatePercentages:function(){l.allItems.exp.forEach(function(e){return e.calculatePercentages(l.totals.inc)})},returnPercenatehs:function(){var e=l.allItems.exp.forEach(function(e){return e.getPercentages()});return console.log(e+", isso aqui"),e}}}(),uiController=function(){var c={type:".add__type",desc:".add__description",value:".add__value",btn:".add__btn",incList:".income__list",expList:".expenses__list",container:".container",budget:".budget__value",income_lable:".budget__income--value",expense_lable:".budget__expenses--value",month:".budget__title--month",percentage:".budget__expenses--percentage"};return{inputVals:function(){return{getType:document.querySelector(c.type).value,getDesc:document.querySelector(c.desc).value,getValue:parseInt(document.querySelector(c.value).value)}},globalInput:function(){return c},addItem:function(e,t){var n=void 0,i=void 0,a=void 0;"inc"===e?(a=c.incList,n='<div class="item clearfix" id="inc-%id%"> <div class="item__description">%desc%</div> <div class="right clearfix"> <div class="item__value">%val%</div> <div class="item__delete"> <button class="item__delete--btn"><i class="ion-ios-close-outline"></i></button> </div> </div> </div>'):"exp"===e&&(a=c.expList,n='<div class="item clearfix" id="exp-%id%"> <div class="item__description">%desc%</div> <div class="right clearfix"> <div class="item__value">%val%</div> <div class="item__percentage">21%</div> <div class="item__delete"> <button class="item__delete--btn"><i class="ion-ios-close-outline"></i></button> </div> </div> </div>'),i=(i=(i=n.replace("%id%",t.id)).replace("%desc%",t.description)).replace("%val%",t.value),document.querySelector(a).insertAdjacentHTML("beforeend",i)},displayBudget:function(e){document.querySelector(c.budget).textContent=e.budget,document.querySelector(c.income_lable).textContent=e.incLable,document.querySelector(c.expense_lable).textContent=e.expLable,document.querySelector(c.percentage).textContent=e.percentage}}}(),controller=function(c,n){var e=n.globalInput(),l=function(){var e;c.calculateBudget(),e=c.getBudget(),n.displayBudget(e)},r=function(){c.calculatePercentages(),c.returnPercenatehs()},t=function(e){var t=void 0,n=void 0,i=void 0,a=void 0;(t=e.target.parentNode.parentNode.parentNode.parentNode.id)&&(i=(n=t.split("-"))[0],a=parseFloat(n[1]),c.deleteItem(i,a),l(),r())},i=function(){var e,t;e=n.inputVals(),t=c.addItem(e.getType,e.getDesc,e.getValue),n.addItem(e.getType,t),l(),r()};return{init:function(){document.querySelector(e.btn).addEventListener("click",i),document.addEventListener("keypress",function(e){13!==e.keycode&&13!==e.which||i()}),c.testings(),document.querySelector(e.container).addEventListener("click",t),n.displayBudget({incLable:0,expLable:0,budget:0,percentage:0})}}}(budgetController,uiController);controller.init();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6WyJidWRnZXRDb250cm9sbGVyIiwiY29uc29sZSIsImxvZyIsIkV4cGVuc2UiLCJpZCIsImRlc2NyaXB0aW9uIiwidmFsdWUiLCJfY2xhc3NDYWxsQ2hlY2siLCJ0aGlzIiwiX2NyZWF0ZUNsYXNzIiwia2V5IiwidG90YWxJbmNvbWUiLCJwZXJjZW50YWdlcyIsIk1hdGgiLCJyb3VuZCIsIkluY29tZSIsImRhdGEiLCJhbGxJdGVtcyIsImluYyIsImV4cCIsInRvdGFscyIsInBlcmNlbnRhZ2UiLCJjYWxjVG90YWxzIiwidHlwZSIsInN1bSIsImZvckVhY2giLCJjdXJyIiwibmV3SXRlbSIsIklEIiwibGVuZ3RoIiwicHVzaCIsInRlc3RpbmdzIiwiY2FsY3VsYXRlQnVkZ2V0IiwiZ2V0QnVkZ2V0IiwiZXhwTGFibGUiLCJidWRnZXQiLCJpbmRleCIsInNwbGljZSIsImNhbGN1bGF0ZVBlcmNlbnRhZ2VzIiwicmV0dXJuUGVyY2VuYXRlaHMiLCJnZXRQZXJjZW50YWdlcyIsImluY0xhYmxlIiwicGVyY2UiLCJkZWxldGVJdGVtIiwiZG9tc3RyaW5ncyIsIml0ZW0iLCJidG4iLCJleHBMaXN0IiwiaW5jb21lX2xhYmxlIiwiZ2V0VHlwZSIsImdldERlc2MiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJkZXNjIiwiZ2xvYmFsSW5wdXQiLCJvYmoiLCJodG1sIiwibmV3SHRtbCIsImVsZW1lbnQiLCJpbmNMaXN0IiwiY29udGFpbmVyIiwibW9udGgiLCJleHBlbnNlX2xhYmxlIiwicmVwbGFjZSIsImluc2VydEFkamFjZW50SFRNTCIsImRpc3BsYXlCdWRnZXQiLCJpbnB1dFZhbHMiLCJ0ZXh0Q29udGVudCIsImNvbnRyb2xsZXIiLCJ1aUN0cmwiLCJEb20iLCJ1cGRhdGVCdWRnZXQiLCJidWRnZXRDdHJsIiwiaW5wdXQiLCJnZXRWYWx1ZSIsImNhbGN1bGF0ZVBlcmNlbmF0YWdlcyIsImluaXQiLCJzcGxpdGVkSXRlbSIsImFkZEV2ZW50TGlzdGVuZXIiLCJjb250cm9sQWRkSXRlbSIsImUiLCJ3aGljaCIsImNvbnN0cm9sbERlbGV0ZUl0ZW0iXSwibWFwcGluZ3MiOiI2WEFBQSxJQUFNQSxpQkFBb0IsV0FDdEJDLFFBQVFDLElBQUksV0FEZ0IsV0FJeEIsU0FBQUMsRUFBWUMsRUFBSUMsRUFBYUMsR0FBT0MsZ0JBQUFDLEtBQUFMLEdBQ2hDSyxLQUFLSixHQUFLQSxFQUxoQkosS0FBQUEsWUFBb0JLLEVBQ2RILEtBQUlJLE1BQVpBLEVBRDRCRyxhQUFBTixFQUFBLENBQUEsQ0FBQU8sSUFBQSx1QkFBQUosTUFBQSxTQUFBSyxHQUlZSCxLQUFBSSxZQUFwQ0QsRUFBb0NFLEtBQUFDLE1BQUFOLEtBQUFGLE1BQUFLLEVBQUEsTUFDaEMsSUFMb0IsQ0FBQUQsSUFBQSxpQkFBQUosTUFBQSxXQWlCcEIsT0FBT0UsS0FBS0ksZ0JBakJRLEdBQUEsSUFVcEJHLEVBQ0ksU0FBQUEsRUFBQVgsRUFBQUMsRUFBQUMsR0FBd0JRLGdCQUFBQSxLQUFBQSxHQUMzQk4sS0FGREosR0FBQUEsRUFHSUksS0FBQUgsWUFBS08sRUFDUkosS0FBQUYsTUFBQUEsR0FkbUJVLEVBQUEsQ0FBQUMsU0FBQSxDQWlCcEJDLElBQUEsR0FDSEMsSUFBQSxJQWVEQyxPQUFRLENBakNnQkYsSUFBQSxFQUFBQyxJQUFBLEdBcUJ0QkosT0FyQnNCLEVBc0JZTSxZQUFBLEdBRWhDQyxFQUFLakIsU0FBTGtCLEdBQ0EsSUFBQUMsRUFBQSxFQUtBTixPQTlCb0JGLEVBQUFDLFNBQUFNLEdBQUFFLFFBQUEsU0FBQUMsR0FBQSxPQUFBRixHQUFBRSxFQUFBcEIsUUE0QnhCVSxFQUFBQSxPQUFPTyxHQUFBQyxHQUtQSixNQUFBQSxDQUNJRixRQUFLLFNBRERLLEVBQUFsQixFQUFBQyxHQUVKYSxJQUFBQSxPQUFBQSxFQUFLUSxPQUFBQSxFQVVUWCxPQVJRWSxFQVRELEVBQUFaLEVBQUFDLFNBQUFNLEdBQUFNLE9BQUFiLEVBQUFDLFNBQUFNLEdBQUFQLEVBQUFDLFNBQUFNLEdBQUFNLE9BQUEsR0FBQXpCLEdBQUEsRUFBWCxFQWFtQixRQUFia0IsRUFDRUUsRUFBSixJQUFBVCxFQUFBYSxFQUFBdkIsRUFBQUMsR0FDb0JtQixRQUFORixJQUFjSSxFQUFlRCxJQUFBQSxFQUFmRSxFQUFBdkIsRUFBQUMsSUFvQnhCVSxFQUFLQyxTQUFTTSxHQUFNTyxLQUFLSCxHQWxCN0JBLEdBRUFJLFNBQUEsV0FOSixPQUFBZixHQVNBZ0IsZ0JBQU8sV0FFQ1YsRUFBSU0sT0FBSk4sRUFBUUssT0FFSkMsRUFBQUEsT0FBVVgsRUFBQUEsT0FBU00sSUFBTVAsRUFBS0MsT0FBU00sSUFDMUN0QixRQUFNQyxJQUFBYyxFQUFBSSxPQUFBRixLQUVOLEVBQUFGLEVBQUFJLE9BQUFGLElBQ0dLLEVBQUFBLFdBQWdCVixLQUFBQyxNQUFBRSxFQUFBSSxPQUFBRCxJQUFBSCxFQUFBSSxPQUFBRixJQUFBLEtBR2hCUyxFQUFBQSxZQUFjWixHQUdsQmtCLFVBQU9OLFdBZFIsTUFBQSxDQWdCSEksU0FBVWYsRUFBQUksT0FBTUYsSUFDWmdCLFNBQUFsQixFQUFBSSxPQUFBRCxJQWpCRGdCLE9BQUFuQixFQUFBbUIsT0FtQkhILFdBQWlCaEIsRUFBQUssYUFHYkMsV0FBQUEsU0FBQUEsRUFBV00sR0FDWCxJQUFBUSxHQUdBLEtBREFuQyxFQURLa0MsRUFBTGxCLFNBQW1CRyxHQUFPRixJQUFaLFNBQUFRLEdBQUEsT0FBdUJOLEVBQU9ELEtBQ2hDSCxRQUFLSSxLQUViSixFQUFLSSxTQUFPRixHQUFoQm1CLE9BQXlCRCxFQUFBLElBdUI3QkUscUJBQXNCLFdBbkJkdEIsRUFBQUEsU0FBS0ssSUFBQUEsUUFBTCxTQUFBSyxHQUFBLE9BQUFBLEVBQUFZLHFCQUFBdEIsRUFBQUksT0FBQUYsUUFFUHFCLGtCQWpDRSxXQWtDSE4sSUFBQUEsRUFBV2pCLEVBQUFDLFNBQUFFLElBQUlNLFFBQUEsU0FBQUMsR0FBQSxPQUFBQSxFQUFBYyxtQkFFTkMsT0FETHhDLFFBQU1DLElBQUF3QyxFQUFOLGVBQ0tELElBdEZTLEdBNEZsQkUsYUFBWSxXQUNSLElBQUFDLEVBQUlDLENBQUp0QixLQUFBLGFBQ0FzQixLQUFBQSxvQkFBK0J2QyxNQUFBLGNBQUF3QyxJQUF4QixZQUNQVixRQUFBQSxnQkFDQVcsUUFBR1gsa0JBQ0NwQixVQUFBQSxhQUNIbUIsT0FBQSxpQkFDSmEsYUFqREUseUJBa0RIVixjQUFBQSwyQkFDSXRCLE1BQUFBLHdCQUEwQkssV0FBQSxpQ0FDN0IsTUFwREUsQ0FxREhrQixVQUFBQSxXQUNJLE1BQUlHLENBQWtDTyxRQUFNdkIsU0FBS2MsY0FBWEksRUFBQXJCLE1BQUFqQixNQUF0QzRDLFFBQUFDLFNBQUFDLGNBQUFSLEVBQUFTLE1BQUEvQyxNQUNBTCxTQUFleUMsU0FBZlMsU0FBQUMsY0FBQVIsRUFBQXRDLE9BQUFBLFNBdkRSZ0QsWUFBQSxXQWxESixPQUFBVixHQWlIUUEsUUFBQUEsU0FBQUEsRUFBYVcsR0FDYmhDLElBQU1pQyxPQUFBQSxFQUFBQyxPQUFBQSxFQURPQyxPQUFBQSxFQUVQLFFBQUFuQyxHQUNDbUMsRUFBQWQsRUFITWUsUUFJUkgsRUFBQSw0UkFKUSxRQUtKakMsSUFDVHdCLEVBQVNILEVBTklHLFFBT2JhLEVBQVcsb1VBSVhDLEdBREFDLEdBREFkLEVBQWNRLEVBQUFPLFFBQUEsT0FBQVIsRUFURG5ELEtBVUUyRCxRQUFBLFNBQUFSLEVBVkZsRCxjQVdOMEQsUUFYTSxRQUFBUixFQUFBakQsT0FZYmUsU0FBWStCLGNBQUFNLEdBQUFNLG1CQUFBLFlBQUFQLElBRWhCUSxjQUFPLFNBQUFWLEdBQ0hXLFNBQVdkLGNBQUFSLEVBQU1ULFFBQUFnQyxZQUFBWixFQUFBcEIsT0FDYmdCLFNBQU9DLGNBQUFSLEVBQUFJLGNBQUFtQixZQUFBWixFQUFBZCxTQUNIUSxTQUFBQSxjQUFrQkcsRUFBQUEsZUFBeUI3QixZQUR4Q2dDLEVBQUFyQixTQUVIZ0IsU0FBQUEsY0FBa0JFLEVBQUFBLFlBQWNSLFlBRjdCVyxFQUFBbEMsYUFyQ0MsR0E0Q1IrQyxXQUFPeEIsU0FBQUEsRUFBUHlCLEdBQ0gsSUFBQUMsRUFWRUQsRUFBQWYsY0FZQ2lCLEVBQUlmLFdBQUosSUFBQXJCLEVBQUFxQyxFQUFtQmQsa0JBQ25CdkIsRUFBSVosRUFBU1UsWUFFVHVCLEVBQUFBLGNBQU9yQixJQUVQdUIsRUFBVWQsV0FDVlksRUFBQUEsdUJBQ0hnQixFQUFBakMscUJBRURrQixFQUFrQk0sU0FBQUEsR0FDbEJOLElBQUFBLE9BQUFBLEVBQUFBLE9BQUFBLEVBQWtCTSxPQUFBQSxFQUFSbkMsT0FBQUEsR0FDVnVCLEVBQUFBLEVBQUFBLE9BQVNDLFdBQWNNLFdBQVNNLFdBQUFBLFdBQW1CNUQsTUFJbkQrQyxHQURBQSxFQUFTQyxFQUFBQSxNQUFjUixNQUNkUSxHQUNURCxFQUFBQSxXQUFTQyxFQUFjUixJQUUxQjRCLEVBQUE3QixXQUFBcEIsRUFBQUssR0E5QkwyQyxJQWtDRUgsTUFHSUcsRUFBZSxXQUNqQixJQUFJcEMsRUFBQUEsRUFDSnFDLEVBQUFBLEVBQVd4QyxZQUNYRyxFQUFTcUMsRUFBV3ZDLFFBQVh3QyxFQUFUeEIsUUFBQXdCLEVBQUF2QixRQUFBdUIsRUFBQUMsVUFFQUwsRUFBT0osUUFBQUEsRUFBYzlCLFFBQXJCUixHQUVFZ0QsSUFFRkgsS0FhSUQsTUFBQUEsQ0ErQkpLLEtBQU0sV0F6Q056QixTQUFVMEIsY0FBQUEsRUFBVi9CLEtBQUFnQyxpQkFBQSxRQUFBQyxHQUFBNUIsU0FBdUI1QixpQkFBdkIsV0FBQSxTQUFBeUQsR0FBQSxLQUE2QnBELEVBQUFBLFNBQTdCLEtBQUFvRCxFQUFBQyxPQUNPRCxNQUlIekQsRUFBT3NELFdBZ0NYMUIsU0FBU0MsY0FBY2tCLEVBQUlWLFdBQVdrQixpQkFBaUIsUUFBU0ksR0F4Qi9EYixFQUFBSixjQUFBLENBZEx4QixTQUFBLEVBZ0JNc0MsU0FBaUIsRUFDZk4sT0FBQUEsRUFBTzlDLFdBQVgsTUF4RFdpQixDQThEWDJCLGlCQUFBQSxjQWdDUkgsV0FBV1EiLCJmaWxlIjoiYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgYnVkZ2V0Q29udHJvbGxlciA9ICgoKSA9PiB7XG4gICAgY29uc29sZS5sb2coJ0J1ZGdldCcpO1xuXG4gICAgY2xhc3MgRXhwZW5zZSB7XG4gICAgICAgIGNvbnN0cnVjdG9yKGlkLCBkZXNjcmlwdGlvbiwgdmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuaWQgPSBpZDtcbiAgICAgICAgICAgIHRoaXMuZGVzY3JpcHRpb24gPSBkZXNjcmlwdGlvbjtcbiAgICAgICAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBjYWxjdWxhdGVQZXJjZW50YWdlcyAodG90YWxJbmNvbWUpe1xuICAgICAgICAgICAgaWYodG90YWxJbmNvbWUpe1xuICAgICAgICAgICAgICAgIHRoaXMucGVyY2VudGFnZXMgPSBNYXRoLnJvdW5kKCh0aGlzLnZhbHVlIC8gdG90YWxJbmNvbWUpICogMTAwKTtcbiAgICAgICAgICAgIH1lbHNle1xuICAgICAgICAgICAgICAgIHRoaXMucGVyY2VudGFnZXMgPSAtMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBnZXRQZXJjZW50YWdlcyAoKXtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnBlcmNlbnRhZ2VzO1xuICAgICAgICB9XG4gICAgfVxuICAgIFxuICAgIGNsYXNzIEluY29tZSB7XG4gICAgICAgIGNvbnN0cnVjdG9yKGlkLCBkZXNjcmlwdGlvbiwgdmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuaWQgPSBpZDtcbiAgICAgICAgICAgIHRoaXMuZGVzY3JpcHRpb24gPSBkZXNjcmlwdGlvbjtcbiAgICAgICAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBsZXQgZGF0YSA9IHtcbiAgICAgICAgYWxsSXRlbXM6IHtcbiAgICAgICAgICAgIGluYzogW10sXG4gICAgICAgICAgICBleHA6IFtdXG4gICAgICAgIH0sXG4gICAgICAgIHRvdGFsczoge1xuICAgICAgICAgICAgaW5jOiAwLFxuICAgICAgICAgICAgZXhwOiAwXG4gICAgICAgIH0sXG4gICAgICAgIGJ1ZGdldDogMCxcbiAgICAgICAgcGVyY2VudGFnZTogLTFcbiAgICB9O1xuXG4gICAgY29uc3QgY2FsY1RvdGFscyA9ICh0eXBlKSA9PiB7XG4gICAgICAgIGxldCBzdW0gPSAwO1xuICAgICAgICBkYXRhLmFsbEl0ZW1zW3R5cGVdLmZvckVhY2goY3VyciA9PiBzdW0gKz0gY3Vyci52YWx1ZSk7XG5cbiAgICAgICAgZGF0YS50b3RhbHNbdHlwZV0gPSBzdW07XG5cbiAgICAgICAgcmV0dXJuIHN1bTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgYWRkSXRlbTogKHR5cGUsIGRlc2NyaXB0aW9uLCB2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgbGV0IElELCBuZXdJdGVtO1xuICAgICAgICAgICAgaWYgKGRhdGEuYWxsSXRlbXNbdHlwZV0ubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIElEID0gZGF0YS5hbGxJdGVtc1t0eXBlXVtkYXRhLmFsbEl0ZW1zW3R5cGVdLmxlbmd0aCAtIDFdLmlkICsgMTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgSUQgPSAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHR5cGUgPT09ICdpbmMnKSB7XG4gICAgICAgICAgICAgICAgbmV3SXRlbSA9IG5ldyBJbmNvbWUoSUQsIGRlc2NyaXB0aW9uLCB2YWx1ZSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICdleHAnKSB7XG4gICAgICAgICAgICAgICAgbmV3SXRlbSA9IG5ldyBJbmNvbWUoSUQsIGRlc2NyaXB0aW9uLCB2YWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBkYXRhLmFsbEl0ZW1zW3R5cGVdLnB1c2gobmV3SXRlbSk7XG4gICAgICAgICAgICByZXR1cm4gbmV3SXRlbTtcbiAgICAgICAgfSxcbiAgICAgICAgdGVzdGluZ3M6ICgpID0+IHtcbiAgICAgICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgICB9LFxuICAgICAgICBjYWxjdWxhdGVCdWRnZXQ6ICgpID0+IHtcbiAgICAgICAgICAgIC8vICBjYWxjIFRvdGxhc1xuICAgICAgICAgICAgY2FsY1RvdGFscygnaW5jJyk7XG4gICAgICAgICAgICBjYWxjVG90YWxzKCdleHAnKTtcbiAgICAgICAgICAgIC8vIGNhbGMgYnVkZ2V0XG4gICAgICAgICAgICBkYXRhLmJ1ZGdldCA9IGRhdGEudG90YWxzLmluYyAtIGRhdGEudG90YWxzLmV4cDtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGEudG90YWxzLmluYyk7XG4gICAgICAgICAgICAvLyBDYWxjIHBlcmNlbnRhZ2UgXG4gICAgICAgICAgICBpZiAoZGF0YS50b3RhbHMuaW5jID4gMCkge1xuICAgICAgICAgICAgICAgIGRhdGEucGVyY2VudGFnZSA9IE1hdGgucm91bmQoKGRhdGEudG90YWxzLmV4cCAvIGRhdGEudG90YWxzLmluYykgKiAxMDApO1xuICAgICAgICAgICAgfWVsc2Uge1xuXG4gICAgICAgICAgICAgICAgZGF0YS5wZXJjZW50YWdlID0gLTE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGdldEJ1ZGdldDogKCk9PntcbiAgICAgICAgICAgIHJldHVybntcbiAgICAgICAgICAgICAgICAgaW5jTGFibGU6IGRhdGEudG90YWxzLmluYyxcbiAgICAgICAgICAgICAgICAgZXhwTGFibGU6IGRhdGEudG90YWxzLmV4cCxcbiAgICAgICAgICAgICAgICAgYnVkZ2V0OiBkYXRhLmJ1ZGdldCxcbiAgICAgICAgICAgICAgICAgcGVyY2VudGFnZTogZGF0YS5wZXJjZW50YWdlXG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGRlbGV0ZUl0ZW06ICh0eXBlLCBJRCk9PntcbiAgICAgICAgICAgIGxldCBpdGVtLCBpbmRleDtcbiAgICAgICAgICAgIGl0ZW0gPSBkYXRhLmFsbEl0ZW1zW3R5cGVdLm1hcChjdXJyID0+IGN1cnIuaWQpO1xuICAgICAgICAgICAgaW5kZXggPSBpdGVtLmluZGV4T2YoSUQpO1xuICAgICAgICAgICAgaWYoaW5kZXggIT09ICAtMSApe1xuICAgICAgICAgICAgICAgIGRhdGEuYWxsSXRlbXNbdHlwZV0uc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgY2FsY3VsYXRlUGVyY2VudGFnZXM6ICgpID0+e1xuICAgICAgICAgICAgZGF0YS5hbGxJdGVtcy5leHAuZm9yRWFjaChjdXJyID0+IGN1cnIuY2FsY3VsYXRlUGVyY2VudGFnZXMoZGF0YS50b3RhbHMuaW5jKSk7XG4gICAgICAgIH0sXG4gICAgICAgIHJldHVyblBlcmNlbmF0ZWhzOiAoKT0+e1xuICAgICAgICAgICAgbGV0IHBlcmNlID0gZGF0YS5hbGxJdGVtcy5leHAuZm9yRWFjaChjdXJyPT5jdXJyLmdldFBlcmNlbnRhZ2VzKCkpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coYCR7cGVyY2V9LCBpc3NvIGFxdWlgKTtcbiAgICAgICAgICAgIHJldHVybiBwZXJjZTtcbiAgICAgICAgfVxuICAgIH07XG5cblxufSkoKTtcbmNvbnN0IHVpQ29udHJvbGxlciA9ICgoKSA9PiB7XG4gICAgbGV0IGRvbXN0cmluZ3MgPSB7XG4gICAgICAgIHR5cGU6IFwiLmFkZF9fdHlwZVwiLFxuICAgICAgICBkZXNjOiBcIi5hZGRfX2Rlc2NyaXB0aW9uXCIsXG4gICAgICAgIHZhbHVlOiBcIi5hZGRfX3ZhbHVlXCIsXG4gICAgICAgIGJ0bjogXCIuYWRkX19idG5cIixcbiAgICAgICAgaW5jTGlzdDogXCIuaW5jb21lX19saXN0XCIsXG4gICAgICAgIGV4cExpc3Q6IFwiLmV4cGVuc2VzX19saXN0XCIsXG4gICAgICAgIGNvbnRhaW5lcjogXCIuY29udGFpbmVyXCIsXG4gICAgICAgIGJ1ZGdldDogXCIuYnVkZ2V0X192YWx1ZVwiLFxuICAgICAgICBpbmNvbWVfbGFibGU6IFwiLmJ1ZGdldF9faW5jb21lLS12YWx1ZVwiLFxuICAgICAgICBleHBlbnNlX2xhYmxlOiBcIi5idWRnZXRfX2V4cGVuc2VzLS12YWx1ZVwiLFxuICAgICAgICBtb250aDogXCIuYnVkZ2V0X190aXRsZS0tbW9udGhcIixcbiAgICAgICAgcGVyY2VudGFnZTogXCIuYnVkZ2V0X19leHBlbnNlcy0tcGVyY2VudGFnZVwiXG4gICAgfTtcbiAgICByZXR1cm4ge1xuICAgICAgICBpbnB1dFZhbHM6ICgpID0+IHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgZ2V0VHlwZTogZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihkb21zdHJpbmdzLnR5cGUpLnZhbHVlLFxuICAgICAgICAgICAgICAgIGdldERlc2M6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoZG9tc3RyaW5ncy5kZXNjKS52YWx1ZSxcbiAgICAgICAgICAgICAgICBnZXRWYWx1ZTogcGFyc2VJbnQoZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihkb21zdHJpbmdzLnZhbHVlKS52YWx1ZSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgZ2xvYmFsSW5wdXQ6ICgpID0+IHtcbiAgICAgICAgICAgIHJldHVybiBkb21zdHJpbmdzO1xuICAgICAgICB9LFxuICAgICAgICBhZGRJdGVtOiAodHlwZSwgb2JqKSA9PiB7XG4gICAgICAgICAgICBsZXQgaHRtbCwgbmV3SHRtbCwgZWxlbWVudDtcbiAgICAgICAgICAgIGlmICh0eXBlID09PSAnaW5jJykge1xuICAgICAgICAgICAgICAgIGVsZW1lbnQgPSBkb21zdHJpbmdzLmluY0xpc3Q7XG4gICAgICAgICAgICAgICAgaHRtbCA9ICc8ZGl2IGNsYXNzPVwiaXRlbSBjbGVhcmZpeFwiIGlkPVwiaW5jLSVpZCVcIj4gPGRpdiBjbGFzcz1cIml0ZW1fX2Rlc2NyaXB0aW9uXCI+JWRlc2MlPC9kaXY+IDxkaXYgY2xhc3M9XCJyaWdodCBjbGVhcmZpeFwiPiA8ZGl2IGNsYXNzPVwiaXRlbV9fdmFsdWVcIj4ldmFsJTwvZGl2PiA8ZGl2IGNsYXNzPVwiaXRlbV9fZGVsZXRlXCI+IDxidXR0b24gY2xhc3M9XCJpdGVtX19kZWxldGUtLWJ0blwiPjxpIGNsYXNzPVwiaW9uLWlvcy1jbG9zZS1vdXRsaW5lXCI+PC9pPjwvYnV0dG9uPiA8L2Rpdj4gPC9kaXY+IDwvZGl2Pic7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICdleHAnKSB7XG4gICAgICAgICAgICAgICAgZWxlbWVudCA9IGRvbXN0cmluZ3MuZXhwTGlzdDtcbiAgICAgICAgICAgICAgICBodG1sID0gJzxkaXYgY2xhc3M9XCJpdGVtIGNsZWFyZml4XCIgaWQ9XCJleHAtJWlkJVwiPiA8ZGl2IGNsYXNzPVwiaXRlbV9fZGVzY3JpcHRpb25cIj4lZGVzYyU8L2Rpdj4gPGRpdiBjbGFzcz1cInJpZ2h0IGNsZWFyZml4XCI+IDxkaXYgY2xhc3M9XCJpdGVtX192YWx1ZVwiPiV2YWwlPC9kaXY+IDxkaXYgY2xhc3M9XCJpdGVtX19wZXJjZW50YWdlXCI+MjElPC9kaXY+IDxkaXYgY2xhc3M9XCJpdGVtX19kZWxldGVcIj4gPGJ1dHRvbiBjbGFzcz1cIml0ZW1fX2RlbGV0ZS0tYnRuXCI+PGkgY2xhc3M9XCJpb24taW9zLWNsb3NlLW91dGxpbmVcIj48L2k+PC9idXR0b24+IDwvZGl2PiA8L2Rpdj4gPC9kaXY+JztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG5ld0h0bWwgPSBodG1sLnJlcGxhY2UoJyVpZCUnLCBvYmouaWQpO1xuICAgICAgICAgICAgbmV3SHRtbCA9IG5ld0h0bWwucmVwbGFjZSgnJWRlc2MlJywgb2JqLmRlc2NyaXB0aW9uKTtcbiAgICAgICAgICAgIG5ld0h0bWwgPSBuZXdIdG1sLnJlcGxhY2UoJyV2YWwlJywgb2JqLnZhbHVlKTtcbiAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoZWxlbWVudCkuaW5zZXJ0QWRqYWNlbnRIVE1MKCdiZWZvcmVlbmQnLCBuZXdIdG1sKTtcbiAgICAgICAgfSxcbiAgICAgICAgZGlzcGxheUJ1ZGdldDogKG9iaik9PntcbiAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoZG9tc3RyaW5ncy5idWRnZXQpLnRleHRDb250ZW50ID0gb2JqLmJ1ZGdldDtcbiAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoZG9tc3RyaW5ncy5pbmNvbWVfbGFibGUpLnRleHRDb250ZW50ID0gb2JqLmluY0xhYmxlO1xuICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihkb21zdHJpbmdzLmV4cGVuc2VfbGFibGUpLnRleHRDb250ZW50ID0gb2JqLmV4cExhYmxlO1xuICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihkb21zdHJpbmdzLnBlcmNlbnRhZ2UpLnRleHRDb250ZW50ID0gb2JqLnBlcmNlbnRhZ2U7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgfVxufSkoKTtcbmNvbnN0IGNvbnRyb2xsZXIgPSAoKGJ1ZGdldEN0cmwsIHVpQ3RybCkgPT4ge1xuICAgIGxldCBEb20gPSB1aUN0cmwuZ2xvYmFsSW5wdXQoKTtcblxuICAgIGNvbnN0IHVwZGF0ZUJ1ZGdldCA9ICgpID0+IHtcbiAgICAgICAgbGV0IGJ1ZGdldDtcbiAgICAgICAgYnVkZ2V0Q3RybC5jYWxjdWxhdGVCdWRnZXQoKTtcbiAgICAgICAgYnVkZ2V0ID0gYnVkZ2V0Q3RybC5nZXRCdWRnZXQoKTtcblxuICAgICAgICB1aUN0cmwuZGlzcGxheUJ1ZGdldChidWRnZXQpO1xuICAgIH07XG4gICAgY29uc3QgY2FsY3VsYXRlUGVyY2VuYXRhZ2VzID0gKCk9PntcbiAgICAgICAgYnVkZ2V0Q3RybC5jYWxjdWxhdGVQZXJjZW50YWdlcygpOyBcbiAgICAgICAgYnVkZ2V0Q3RybC5yZXR1cm5QZXJjZW5hdGVocygpO1xuICAgIH07XG4gICAgY29uc3QgY29uc3Ryb2xsRGVsZXRlSXRlbSA9IChlKT0+e1xuICAgICAgICBsZXQgaXRlbSwgc3BsaXRlZEl0ZW0sIHR5cGUsIElEO1xuICAgICAgICBpdGVtID0gZS50YXJnZXQucGFyZW50Tm9kZS5wYXJlbnROb2RlLnBhcmVudE5vZGUucGFyZW50Tm9kZS5pZDtcbiAgICAgICAgaWYoaXRlbSl7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHNwbGl0ZWRJdGVtID0gaXRlbS5zcGxpdCgnLScpO1xuICAgICAgICAgICAgdHlwZSA9IHNwbGl0ZWRJdGVtWzBdO1xuICAgICAgICAgICAgSUQgPSAgcGFyc2VGbG9hdChzcGxpdGVkSXRlbVsxXSk7XG5cbiAgICAgICAgICAgIGJ1ZGdldEN0cmwuZGVsZXRlSXRlbSh0eXBlLCBJRCk7XG5cbiAgICAgICAgICAgIHVwZGF0ZUJ1ZGdldCgpO1xuXG4gICAgICAgICAgICBjYWxjdWxhdGVQZXJjZW5hdGFnZXMoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgY29uc3QgY29udHJvbEFkZEl0ZW0gPSAoKSA9PiB7XG4gICAgICAgIGxldCBpbnB1dCwgbmV3SXRlbTtcbiAgICAgICAgaW5wdXQgPSB1aUN0cmwuaW5wdXRWYWxzKCk7XG4gICAgICAgIG5ld0l0ZW0gPSBidWRnZXRDdHJsLmFkZEl0ZW0oaW5wdXQuZ2V0VHlwZSwgaW5wdXQuZ2V0RGVzYywgaW5wdXQuZ2V0VmFsdWUpO1xuXG4gICAgICAgIHVpQ3RybC5hZGRJdGVtKGlucHV0LmdldFR5cGUsIG5ld0l0ZW0pO1xuXG4gICAgICAgIHVwZGF0ZUJ1ZGdldCgpO1xuXG4gICAgICAgIGNhbGN1bGF0ZVBlcmNlbmF0YWdlcygpO1xuICAgICAgICBcbiAgICB9O1xuICAgIGNvbnN0IGV2dExpc3RlbmVycyA9ICgpID0+IHtcbiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihEb20uYnRuKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGNvbnRyb2xBZGRJdGVtKTtcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleXByZXNzXCIsIGUgPT4ge1xuICAgICAgICAgICAgaWYgKGUua2V5Y29kZSA9PT0gMTMgfHwgZS53aGljaCA9PT0gMTMpIHtcbiAgICAgICAgICAgICAgICBjb250cm9sQWRkSXRlbSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgZGVidWdnZXI7XG4gICAgICAgIGJ1ZGdldEN0cmwudGVzdGluZ3MoKTtcblxuICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKERvbS5jb250YWluZXIpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY29uc3Ryb2xsRGVsZXRlSXRlbSk7XG4gICAgfTtcbiAgIFxuICAgIHJldHVybiB7XG4gICAgICAgIGluaXQ6ICgpID0+IHtcbiAgICAgICAgICAgIGV2dExpc3RlbmVycygpO1xuICAgICAgICAgICAgdWlDdHJsLmRpc3BsYXlCdWRnZXQoe1xuICAgICAgICAgICAgICAgIGluY0xhYmxlOiAwLFxuICAgICAgICAgICAgICAgIGV4cExhYmxlOiAwLFxuICAgICAgICAgICAgICAgIGJ1ZGdldDogMCxcbiAgICAgICAgICAgICAgICBwZXJjZW50YWdlOiAwXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH07XG5cblxufSkoYnVkZ2V0Q29udHJvbGxlciwgdWlDb250cm9sbGVyKTtcbmNvbnRyb2xsZXIuaW5pdCgpO1xuXG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=

"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var budgetController=function(){console.log("Budget");var c=function e(t,n,i){_classCallCheck(this,e),this.id=t,this.description=n,this.value=i},a={allItems:{inc:[],exp:[]},totals:{inc:0,exp:0},budget:0,percentage:-1},e=function(e){var t=0;return a.allItems[e].forEach(function(e){return t+=e.value}),a.totals[e]=t};return{addItem:function(e,t,n){var i=void 0,l=void 0;return i=0<a.allItems[e].length?a.allItems[e][a.allItems[e].length-1].id+1:0,"inc"===e?l=new c(i,t,n):"exp"===e&&(l=new c(i,t,n)),a.allItems[e].push(l),l},testings:function(){return a},calculateBudget:function(){e("inc"),e("exp"),a.budget=a.totals.inc-a.totals.exp,console.log(a.totals.inc),0<a.totals.inc&&(a.percentage=a.totals.exp/a.totals.inc*100),a.percentage=-1},getBudget:function(){return{incLable:a.totals.inc,expLable:a.totals.exp,budget:a.budget,percentage:a.percentage}},deleteItem:function(e,t){var n;-1!==(n=a.allItems[e].map(function(e){return e.id}).indexOf(t))&&a.allItems[e].splice(n,1)}}}(),uiController=function(){var c={type:".add__type",desc:".add__description",value:".add__value",btn:".add__btn",incList:".income__list",expList:".expenses__list",container:".container",budget:".budget__value",income_lable:".budget__income--value",expense_lable:".budget__expenses--value",month:".budget__title--month",percentage:".budget__expenses--percentage"};return{inputVals:function(){return{getType:document.querySelector(c.type).value,getDesc:document.querySelector(c.desc).value,getValue:parseInt(document.querySelector(c.value).value)}},globalInput:function(){return c},addItem:function(e,t){var n=void 0,i=void 0,l=void 0;"inc"===e?(l=c.incList,n='<div class="item clearfix" id="inc-%id%"> <div class="item__description">%desc%</div> <div class="right clearfix"> <div class="item__value">%val%</div> <div class="item__delete"> <button class="item__delete--btn"><i class="ion-ios-close-outline"></i></button> </div> </div> </div>'):"exp"===e&&(l=c.expList,n='<div class="item clearfix" id="exp-%id%"> <div class="item__description">%desc%</div> <div class="right clearfix"> <div class="item__value">%val%</div> <div class="item__percentage">21%</div> <div class="item__delete"> <button class="item__delete--btn"><i class="ion-ios-close-outline"></i></button> </div> </div> </div>'),i=(i=(i=n.replace("%id%",t.id)).replace("%desc%",t.description)).replace("%val%",t.value),document.querySelector(l).insertAdjacentHTML("beforeend",i)},displayBudget:function(e){document.querySelector(c.budget).textContent=e.budget,document.querySelector(c.income_lable).textContent=e.incLable,document.querySelector(c.expense_lable).textContent=e.expLable,document.querySelector(c.percentage).textContent=e.percentage}}}(),controller=function(c,n){var e=n.globalInput(),a=function(){var e;c.calculateBudget(),e=c.getBudget(),n.displayBudget(e)},t=function(e){var t=void 0,n=void 0,i=void 0,l=void 0;(t=e.target.parentNode.parentNode.parentNode.parentNode.id)&&(i=(n=t.split("-"))[0],l=parseFloat(n[1]),c.deleteItem(i,l),a())},i=function(){var e,t;e=n.inputVals(),t=c.addItem(e.getType,e.getDesc,e.getValue),n.addItem(e.getType,t),a()};return{init:function(){document.querySelector(e.btn).addEventListener("click",i),document.addEventListener("keypress",function(e){13!==e.keycode&&13!==e.which||i()}),c.testings(),document.querySelector(e.container).addEventListener("click",t),n.displayBudget({incLable:0,expLable:0,budget:0,percentage:0})}}}(budgetController,uiController);controller.init();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6WyJidWRnZXRDb250cm9sbGVyIiwiY29uc29sZSIsImxvZyIsIkluY29tZSIsImRlc2NyaXB0aW9uIiwiX2NsYXNzQ2FsbENoZWNrIiwidGhpcyIsInZhbHVlIiwiZGF0YSIsImFsbEl0ZW1zIiwiaWQiLCJpbmMiLCJleHAiLCJ0b3RhbHMiLCJwZXJjZW50YWdlIiwidHlwZSIsInN1bSIsImNhbGNUb3RhbHMiLCJidWRnZXQiLCJmb3JFYWNoIiwiY3VyciIsImFkZEl0ZW0iLCJJRCIsIm5ld0l0ZW0iLCJsZW5ndGgiLCJ0ZXN0aW5ncyIsImNhbGN1bGF0ZUJ1ZGdldCIsImdldEJ1ZGdldCIsImV4cExhYmxlIiwiZGVsZXRlSXRlbSIsImluZGV4IiwiaW5jTGFibGUiLCJtYXAiLCJzcGxpY2UiLCJpdGVtIiwiZG9tc3RyaW5ncyIsImluY0xpc3QiLCJleHBMaXN0IiwiY29udGFpbmVyIiwidWlDb250cm9sbGVyIiwiZGVzYyIsImJ0biIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImdldERlc2MiLCJpbmNvbWVfbGFibGUiLCJwYXJzZUludCIsImlucHV0VmFscyIsIm9iaiIsImh0bWwiLCJuZXdIdG1sIiwiZWxlbWVudCIsImdldFR5cGUiLCJnZXRWYWx1ZSIsImdsb2JhbElucHV0IiwicmVwbGFjZSIsImluc2VydEFkamFjZW50SFRNTCIsImRpc3BsYXlCdWRnZXQiLCJ0ZXh0Q29udGVudCIsImV4cGVuc2VfbGFibGUiLCJ1aUN0cmwiLCJjb25zdHJvbGxEZWxldGVJdGVtIiwiZSIsInNwbGl0ZWRJdGVtIiwiY29udHJvbGxlciIsInRhcmdldCIsInBhcmVudE5vZGUiLCJidWRnZXRDdHJsIiwidXBkYXRlQnVkZ2V0Iiwic3BsaXQiLCJpbnB1dCIsInBhcnNlRmxvYXQiLCJpbml0IiwiY29udHJvbEFkZEl0ZW0iLCJEb20iLCJ3aGljaCIsImFkZEV2ZW50TGlzdGVuZXIiLCJldnRMaXN0ZW5lcnMiXSwibWFwcGluZ3Mi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QUFBdUMsRUFBQWEsT0FDUWYsTUFpQlJPLEVBQVcxQyxXQW5CZmlCLFNBQUFDLGNBQUErQixFQUFBcEMsV0FBQXNDLGlCQUFBLFFBQUFmLEdBZ0JTRCxFQUFBSCxjQUFBLENBSEwxQixTQUFBLEVBS0FILFNBQUEsRUFDQXVDLE9BQVcxQyxFQVlIWCxXQUFZLE1BdEVoQm9DLENBaUVBMkIsaUJBQUFBLGNBQ0FqQixXQUFBQSIsImZpbGUiOiJhcHAuanMiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBidWRnZXRDb250cm9sbGVyID0gKCgpID0+IHtcbiAgICBjb25zb2xlLmxvZygnQnVkZ2V0Jyk7XG5cbiAgICBjbGFzcyBFeHBlbnNlIHtcbiAgICAgICAgY29uc3RydWN0b3IoaWQsIGRlc2NyaXB0aW9uLCB2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5pZCA9IGlkO1xuICAgICAgICAgICAgdGhpcy5kZXNjcmlwdGlvbiA9IGRlc2NyaXB0aW9uO1xuICAgICAgICAgICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIGNsYXNzIEluY29tZSB7XG4gICAgICAgIGNvbnN0cnVjdG9yKGlkLCBkZXNjcmlwdGlvbiwgdmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuaWQgPSBpZDtcbiAgICAgICAgICAgIHRoaXMuZGVzY3JpcHRpb24gPSBkZXNjcmlwdGlvbjtcbiAgICAgICAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBsZXQgZGF0YSA9IHtcbiAgICAgICAgYWxsSXRlbXM6IHtcbiAgICAgICAgICAgIGluYzogW10sXG4gICAgICAgICAgICBleHA6IFtdXG4gICAgICAgIH0sXG4gICAgICAgIHRvdGFsczoge1xuICAgICAgICAgICAgaW5jOiAwLFxuICAgICAgICAgICAgZXhwOiAwXG4gICAgICAgIH0sXG4gICAgICAgIGJ1ZGdldDogMCxcbiAgICAgICAgcGVyY2VudGFnZTogLTFcbiAgICB9O1xuXG4gICAgY29uc3QgY2FsY1RvdGFscyA9ICh0eXBlKSA9PiB7XG4gICAgICAgIGxldCBzdW0gPSAwO1xuICAgICAgICBkYXRhLmFsbEl0ZW1zW3R5cGVdLmZvckVhY2goY3VyciA9PiBzdW0gKz0gY3Vyci52YWx1ZSk7XG5cbiAgICAgICAgZGF0YS50b3RhbHNbdHlwZV0gPSBzdW07XG5cbiAgICAgICAgcmV0dXJuIHN1bTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgYWRkSXRlbTogKHR5cGUsIGRlc2NyaXB0aW9uLCB2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgbGV0IElELCBuZXdJdGVtO1xuICAgICAgICAgICAgaWYgKGRhdGEuYWxsSXRlbXNbdHlwZV0ubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIElEID0gZGF0YS5hbGxJdGVtc1t0eXBlXVtkYXRhLmFsbEl0ZW1zW3R5cGVdLmxlbmd0aCAtIDFdLmlkICsgMTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgSUQgPSAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHR5cGUgPT09ICdpbmMnKSB7XG4gICAgICAgICAgICAgICAgbmV3SXRlbSA9IG5ldyBJbmNvbWUoSUQsIGRlc2NyaXB0aW9uLCB2YWx1ZSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICdleHAnKSB7XG4gICAgICAgICAgICAgICAgbmV3SXRlbSA9IG5ldyBJbmNvbWUoSUQsIGRlc2NyaXB0aW9uLCB2YWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBkYXRhLmFsbEl0ZW1zW3R5cGVdLnB1c2gobmV3SXRlbSk7XG4gICAgICAgICAgICByZXR1cm4gbmV3SXRlbTtcbiAgICAgICAgfSxcbiAgICAgICAgdGVzdGluZ3M6ICgpID0+IHtcbiAgICAgICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgICB9LFxuICAgICAgICBjYWxjdWxhdGVCdWRnZXQ6ICgpID0+IHtcbiAgICAgICAgICAgIC8vICBjYWxjIFRvdGxhc1xuICAgICAgICAgICAgY2FsY1RvdGFscygnaW5jJyk7XG4gICAgICAgICAgICBjYWxjVG90YWxzKCdleHAnKTtcbiAgICAgICAgICAgIC8vIGNhbGMgYnVkZ2V0XG4gICAgICAgICAgICBkYXRhLmJ1ZGdldCA9IGRhdGEudG90YWxzLmluYyAtIGRhdGEudG90YWxzLmV4cDtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGEudG90YWxzLmluYyk7XG4gICAgICAgICAgICAvLyBDYWxjIHBlcmNlbnRhZ2UgXG4gICAgICAgICAgICBpZiAoZGF0YS50b3RhbHMuaW5jID4gMCkge1xuICAgICAgICAgICAgICAgIGRhdGEucGVyY2VudGFnZSA9IChkYXRhLnRvdGFscy5leHAgLyBkYXRhLnRvdGFscy5pbmMpICogMTAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZGF0YS5wZXJjZW50YWdlID0gLTE7XG4gICAgICAgIH0sXG4gICAgICAgIGdldEJ1ZGdldDogKCk9PntcbiAgICAgICAgICAgIHJldHVybntcbiAgICAgICAgICAgICAgICAgaW5jTGFibGU6IGRhdGEudG90YWxzLmluYyxcbiAgICAgICAgICAgICAgICAgZXhwTGFibGU6IGRhdGEudG90YWxzLmV4cCxcbiAgICAgICAgICAgICAgICAgYnVkZ2V0OiBkYXRhLmJ1ZGdldCxcbiAgICAgICAgICAgICAgICAgcGVyY2VudGFnZTogZGF0YS5wZXJjZW50YWdlXG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGRlbGV0ZUl0ZW06ICh0eXBlLCBJRCk9PntcbiAgICAgICAgICAgIGxldCBpdGVtLCBpbmRleDtcbiAgICAgICAgICAgIGl0ZW0gPSBkYXRhLmFsbEl0ZW1zW3R5cGVdLm1hcChjdXJyID0+IGN1cnIuaWQpO1xuICAgICAgICAgICAgaW5kZXggPSBpdGVtLmluZGV4T2YoSUQpO1xuICAgICAgICAgICAgaWYoaW5kZXggIT09ICAtMSApe1xuICAgICAgICAgICAgICAgIGRhdGEuYWxsSXRlbXNbdHlwZV0uc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG5cblxufSkoKTtcbmNvbnN0IHVpQ29udHJvbGxlciA9ICgoKSA9PiB7XG4gICAgbGV0IGRvbXN0cmluZ3MgPSB7XG4gICAgICAgIHR5cGU6IFwiLmFkZF9fdHlwZVwiLFxuICAgICAgICBkZXNjOiBcIi5hZGRfX2Rlc2NyaXB0aW9uXCIsXG4gICAgICAgIHZhbHVlOiBcIi5hZGRfX3ZhbHVlXCIsXG4gICAgICAgIGJ0bjogXCIuYWRkX19idG5cIixcbiAgICAgICAgaW5jTGlzdDogXCIuaW5jb21lX19saXN0XCIsXG4gICAgICAgIGV4cExpc3Q6IFwiLmV4cGVuc2VzX19saXN0XCIsXG4gICAgICAgIGNvbnRhaW5lcjogXCIuY29udGFpbmVyXCIsXG4gICAgICAgIGJ1ZGdldDogXCIuYnVkZ2V0X192YWx1ZVwiLFxuICAgICAgICBpbmNvbWVfbGFibGU6IFwiLmJ1ZGdldF9faW5jb21lLS12YWx1ZVwiLFxuICAgICAgICBleHBlbnNlX2xhYmxlOiBcIi5idWRnZXRfX2V4cGVuc2VzLS12YWx1ZVwiLFxuICAgICAgICBtb250aDogXCIuYnVkZ2V0X190aXRsZS0tbW9udGhcIixcbiAgICAgICAgcGVyY2VudGFnZTogXCIuYnVkZ2V0X19leHBlbnNlcy0tcGVyY2VudGFnZVwiXG4gICAgfTtcbiAgICByZXR1cm4ge1xuICAgICAgICBpbnB1dFZhbHM6ICgpID0+IHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgZ2V0VHlwZTogZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihkb21zdHJpbmdzLnR5cGUpLnZhbHVlLFxuICAgICAgICAgICAgICAgIGdldERlc2M6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoZG9tc3RyaW5ncy5kZXNjKS52YWx1ZSxcbiAgICAgICAgICAgICAgICBnZXRWYWx1ZTogcGFyc2VJbnQoZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihkb21zdHJpbmdzLnZhbHVlKS52YWx1ZSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgZ2xvYmFsSW5wdXQ6ICgpID0+IHtcbiAgICAgICAgICAgIHJldHVybiBkb21zdHJpbmdzO1xuICAgICAgICB9LFxuICAgICAgICBhZGRJdGVtOiAodHlwZSwgb2JqKSA9PiB7XG4gICAgICAgICAgICBsZXQgaHRtbCwgbmV3SHRtbCwgZWxlbWVudDtcbiAgICAgICAgICAgIGlmICh0eXBlID09PSAnaW5jJykge1xuICAgICAgICAgICAgICAgIGVsZW1lbnQgPSBkb21zdHJpbmdzLmluY0xpc3Q7XG4gICAgICAgICAgICAgICAgaHRtbCA9ICc8ZGl2IGNsYXNzPVwiaXRlbSBjbGVhcmZpeFwiIGlkPVwiaW5jLSVpZCVcIj4gPGRpdiBjbGFzcz1cIml0ZW1fX2Rlc2NyaXB0aW9uXCI+JWRlc2MlPC9kaXY+IDxkaXYgY2xhc3M9XCJyaWdodCBjbGVhcmZpeFwiPiA8ZGl2IGNsYXNzPVwiaXRlbV9fdmFsdWVcIj4ldmFsJTwvZGl2PiA8ZGl2IGNsYXNzPVwiaXRlbV9fZGVsZXRlXCI+IDxidXR0b24gY2xhc3M9XCJpdGVtX19kZWxldGUtLWJ0blwiPjxpIGNsYXNzPVwiaW9uLWlvcy1jbG9zZS1vdXRsaW5lXCI+PC9pPjwvYnV0dG9uPiA8L2Rpdj4gPC9kaXY+IDwvZGl2Pic7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICdleHAnKSB7XG4gICAgICAgICAgICAgICAgZWxlbWVudCA9IGRvbXN0cmluZ3MuZXhwTGlzdDtcbiAgICAgICAgICAgICAgICBodG1sID0gJzxkaXYgY2xhc3M9XCJpdGVtIGNsZWFyZml4XCIgaWQ9XCJleHAtJWlkJVwiPiA8ZGl2IGNsYXNzPVwiaXRlbV9fZGVzY3JpcHRpb25cIj4lZGVzYyU8L2Rpdj4gPGRpdiBjbGFzcz1cInJpZ2h0IGNsZWFyZml4XCI+IDxkaXYgY2xhc3M9XCJpdGVtX192YWx1ZVwiPiV2YWwlPC9kaXY+IDxkaXYgY2xhc3M9XCJpdGVtX19wZXJjZW50YWdlXCI+MjElPC9kaXY+IDxkaXYgY2xhc3M9XCJpdGVtX19kZWxldGVcIj4gPGJ1dHRvbiBjbGFzcz1cIml0ZW1fX2RlbGV0ZS0tYnRuXCI+PGkgY2xhc3M9XCJpb24taW9zLWNsb3NlLW91dGxpbmVcIj48L2k+PC9idXR0b24+IDwvZGl2PiA8L2Rpdj4gPC9kaXY+JztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG5ld0h0bWwgPSBodG1sLnJlcGxhY2UoJyVpZCUnLCBvYmouaWQpO1xuICAgICAgICAgICAgbmV3SHRtbCA9IG5ld0h0bWwucmVwbGFjZSgnJWRlc2MlJywgb2JqLmRlc2NyaXB0aW9uKTtcbiAgICAgICAgICAgIG5ld0h0bWwgPSBuZXdIdG1sLnJlcGxhY2UoJyV2YWwlJywgb2JqLnZhbHVlKTtcbiAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoZWxlbWVudCkuaW5zZXJ0QWRqYWNlbnRIVE1MKCdiZWZvcmVlbmQnLCBuZXdIdG1sKTtcbiAgICAgICAgfSxcbiAgICAgICAgZGlzcGxheUJ1ZGdldDogKG9iaik9PntcbiAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoZG9tc3RyaW5ncy5idWRnZXQpLnRleHRDb250ZW50ID0gb2JqLmJ1ZGdldDtcbiAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoZG9tc3RyaW5ncy5pbmNvbWVfbGFibGUpLnRleHRDb250ZW50ID0gb2JqLmluY0xhYmxlO1xuICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihkb21zdHJpbmdzLmV4cGVuc2VfbGFibGUpLnRleHRDb250ZW50ID0gb2JqLmV4cExhYmxlO1xuICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihkb21zdHJpbmdzLnBlcmNlbnRhZ2UpLnRleHRDb250ZW50ID0gb2JqLnBlcmNlbnRhZ2U7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgfVxufSkoKTtcbmNvbnN0IGNvbnRyb2xsZXIgPSAoKGJ1ZGdldEN0cmwsIHVpQ3RybCkgPT4ge1xuICAgIGxldCBEb20gPSB1aUN0cmwuZ2xvYmFsSW5wdXQoKTtcblxuICAgIGNvbnN0IHVwZGF0ZUJ1ZGdldCA9ICgpID0+IHtcbiAgICAgICAgbGV0IGJ1ZGdldDtcbiAgICAgICAgYnVkZ2V0Q3RybC5jYWxjdWxhdGVCdWRnZXQoKTtcbiAgICAgICAgYnVkZ2V0ID0gYnVkZ2V0Q3RybC5nZXRCdWRnZXQoKTtcblxuICAgICAgICB1aUN0cmwuZGlzcGxheUJ1ZGdldChidWRnZXQpO1xuICAgIH07XG4gICAgY29uc3QgY29uc3Ryb2xsRGVsZXRlSXRlbSA9IChlKT0+e1xuICAgICAgICBsZXQgaXRlbSwgc3BsaXRlZEl0ZW0sIHR5cGUsIElEO1xuICAgICAgICBpdGVtID0gZS50YXJnZXQucGFyZW50Tm9kZS5wYXJlbnROb2RlLnBhcmVudE5vZGUucGFyZW50Tm9kZS5pZDtcbiAgICAgICAgaWYoaXRlbSl7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHNwbGl0ZWRJdGVtID0gaXRlbS5zcGxpdCgnLScpO1xuICAgICAgICAgICAgdHlwZSA9IHNwbGl0ZWRJdGVtWzBdO1xuICAgICAgICAgICAgSUQgPSAgcGFyc2VGbG9hdChzcGxpdGVkSXRlbVsxXSk7XG5cbiAgICAgICAgICAgIGJ1ZGdldEN0cmwuZGVsZXRlSXRlbSh0eXBlLCBJRCk7XG5cbiAgICAgICAgICAgIHVwZGF0ZUJ1ZGdldCgpO1xuXG4gICAgICAgICAgXG5cbiAgICAgICAgfVxuICAgIH07XG4gICAgY29uc3QgY29udHJvbEFkZEl0ZW0gPSAoKSA9PiB7XG4gICAgICAgIGxldCBpbnB1dCwgbmV3SXRlbTtcbiAgICAgICAgaW5wdXQgPSB1aUN0cmwuaW5wdXRWYWxzKCk7XG4gICAgICAgIG5ld0l0ZW0gPSBidWRnZXRDdHJsLmFkZEl0ZW0oaW5wdXQuZ2V0VHlwZSwgaW5wdXQuZ2V0RGVzYywgaW5wdXQuZ2V0VmFsdWUpO1xuXG4gICAgICAgIHVpQ3RybC5hZGRJdGVtKGlucHV0LmdldFR5cGUsIG5ld0l0ZW0pO1xuXG4gICAgICAgIHVwZGF0ZUJ1ZGdldCgpO1xuXG4gICAgICAgIFxuICAgIH07XG4gICAgY29uc3QgZXZ0TGlzdGVuZXJzID0gKCkgPT4ge1xuICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKERvbS5idG4pLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY29udHJvbEFkZEl0ZW0pO1xuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5cHJlc3NcIiwgZSA9PiB7XG4gICAgICAgICAgICBpZiAoZS5rZXljb2RlID09PSAxMyB8fCBlLndoaWNoID09PSAxMykge1xuICAgICAgICAgICAgICAgIGNvbnRyb2xBZGRJdGVtKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBkZWJ1Z2dlcjtcbiAgICAgICAgYnVkZ2V0Q3RybC50ZXN0aW5ncygpO1xuXG4gICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoRG9tLmNvbnRhaW5lcikuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBjb25zdHJvbGxEZWxldGVJdGVtKTtcbiAgICB9O1xuICAgXG4gICAgcmV0dXJuIHtcbiAgICAgICAgaW5pdDogKCkgPT4ge1xuICAgICAgICAgICAgZXZ0TGlzdGVuZXJzKCk7XG4gICAgICAgICAgICB1aUN0cmwuZGlzcGxheUJ1ZGdldCh7XG4gICAgICAgICAgICAgICAgaW5jTGFibGU6IDAsXG4gICAgICAgICAgICAgICAgZXhwTGFibGU6IDAsXG4gICAgICAgICAgICAgICAgYnVkZ2V0OiAwLFxuICAgICAgICAgICAgICAgIHBlcmNlbnRhZ2U6IDBcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfTtcblxuXG59KShidWRnZXRDb250cm9sbGVyLCB1aUNvbnRyb2xsZXIpO1xuY29udHJvbGxlci5pbml0KCk7XG5cbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
